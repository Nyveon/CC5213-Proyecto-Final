11.1-Búsqueda de objetos en videos usando descriptores locales
https://www.youtube.com/watch?v=rEtPl34NXms
 en vídeos anteriores hemos visto cómo estas descriptores locales para buscar objetos y ahora en estas clases vamos a ver cómo buscar objetos pero en vídeos entonces los mismos pasados hablamos sobre cómo buscar objetos y logos o patrones visibles dentro pero comparando dos imágenes imagen contra imagen y veíamos que aparecía el objeto ahora nos interesa ver cómo podemos hacer eso mismo pero sobre una colección grande de imágenes o sobre varios vídeos bueno en principio es en directo cierto podemos ir por freno en su conjunto de frames es la vida tiene ya ver pero podemos hacerlo de esta forma de otras formas por ejemplo con busquen aproximadas otra técnica de los coches de hecho esa técnica al final vamos a ver quién también sirve para clasificación de imágenes como se hacía clasificación de imágenes pero antes de que apareciera titular y las redes convencionales que se esté en realidad sea la forma como se hace ahora vamos a comentar cómo se hacía con iguales es interesante entender esa técnica entonces el problema que nos interesa en estas slides es como buscar la aparición es de uno o más objetos en un conjunto de vídeos y para hacer esto para poder buscar objetos crímenes y tamos tener ejemplos visuales y eso sería por ejemplo aquí aquí queremos buscar este logo o que os buscar esta estatua con una lavadora y estos salen de ejemplo de los mismos vídeos de otros vídeos de fotos que descargó internet pero tengo que dar algún ejemplo visual de lo que estamos buscando y en este caso para este ejemplo sería por ejemplo para este logo aquí de que depende del vídeo donde vamos a buscar todo es un caos que tú enfrente del vídeo y el logo que estamos buscando parece ahí nos estamos buscando [Música] estos ejemplos luego lo saque de una competencia anual quien sea sobre la búsqueda de recursos de información en vídeos que se llama en el training es una competencia es más bien una conferencia académica que se hace todos los años se publican desafíos y este desafío de este año del 2013 texto para hacer desarrollo aquí es el del star search y están sets que es la búsqueda de instancias y se refieren a instancias aquí en este caso nosotros quisiéramos buscar un estatus sino que le interesa buscar a esta estatua esta etapa esta instancia de la clase estado porque hay otros desafíos que son más de buscar clases o categorías pero quien interesa buscar el objeto mismo y estoy interesado en que viene ligado con recuperación de la información multimedia bueno les dejo el link de treki lo concreta incluye también interesante para dar cosas multimedia y data sets y respuestas correcta en este caso publican este dato se trata de un vídeo de una televisión que se llama y enders enders que es una serie de la bbc que tiene como más de 10 años 90 años pero sí tiene la teleserie tiene muchos capítulos y la bbc permitió gustarle al menos algunos años del 2013 a veces que podemos éxito airosa pero si toallas hacer disfraces y lo permite usar para buscar objetos y hallar todo objetos etiquetados interesantes entonces como buscamos objetos la primera opción es la versión más light se podría decir que dice que aquí somos locales para la imagen por imagen para una imagen y lo vamos a hacer framework frame entonces va a recorrer cada vídeo y para cada frame pueden ser todos los frentes algunos frentes vamos a tener sus escritores locales compramos sus escritores locales en el vídeo aquí tenemos las imágenes de consulta de consultas para cada uno de los del vídeo sacamos el frame y comparamos la imagen acá y luego el siguiente y comparamos las dos imágenes en el siguiente y al gráfico problema que es escritor locales y haces parte y escribimos que ya habíamos la segunda semana de los locales y además las coincidencias digitales y la parte de conciencia espacial que hablamos de raza cuatro formas y vamos a recordar sí que encontramos el objeto al puesto frame cuando encontré un modelo con buena cantidad de inglés decimos aquí el objeto hasta aquí podemos decirnos que estaba dentro de extremo en que frei y en qué parte del problema por un poco de números escalables esto según gramos que tenemos del orden de día imágenes de consultante ya que puede ser mismo objeto con distintas vistas y si calculamos escritores locales deberíamos de obtener unos 1000 descriptores locales por cada imagen igual depende el tamaño del objeto pero supongamos eso entonces vamos a tener el ente en total vamos a tener 10.000 de mil vectores de gozón este pase por nuestra tasa de éxito de 128 dimensiones y en un campo supongamos que los va a buscar sobre 200.000 y friends que tras ver como un tamaño razonable de ellos son diferentes no son frames se refiere hablamos de vídeos y frame la idea es que si no tiene un vídeo un vídeo tiene se puede vivir el chotis que son la escena de muy parecida entre civiles de una misma cámara y para cada uno extrae el mejor frente como el mejor y esos son diferentes porque un frame pero que representa y un buen representante de su de ese segmento de video y supongamos que son 200.000 y cada uno como ella está en una escena común que por friend obtengamos 212 mil de escritores hasta un poco más si le interesa buscar objeto en cualquier parte pero según 200.000 que friends con cuánto serie son gramos que juntos un frente dos segundos y si fuera un frente a dos segundos sería esto estos 200.000 que corresponderían a 400 mil segundos segundo de vídeo entonces cuántos y cuántos serían esos 400 mil o tres mil seiscientos si me permiten aquí en 400 mil cuatrocientos mil segundos dividido en 60 por ciento [Música] entonces digamos y una buena serie de hechos la serie de anime grandes alguna vez trabajó en naruto y que son cientos de capítulos uno habla de cientos de vídeos entonces cómo podemos buscar objetos en ese volumen de información entonces usando la técnica que ya vimos la simple encuentro cuánto tiempo nos costaría en principio tenemos que comparar cada uno de los cuánto habíamos dicho los aquí está los cupones nulos los 10.000 descriptores shift hay que compararlo con todos los descriptores de los vídeos que en este caso vendrían a ser 200 mil por 200.000 frames o quien frames por cada uno por dos mil descriptores nos daría 400 millones datos x esencialmente en algún punto cuando buscamos para comparar todos contra todos y por tanto vamos a comparar 10.000 ves que puedes contar 400 millones de escritores is solamente la comparación y siquiera hablamos de raza solamente la comparación diciendo cuánto tiempo es factible o no cuánto tiempo tomaría de la estimación de hecho en el curso un poco el intento para hacer algunas semanas atrás de aquí tengo un pequeño reporte que el extracto de lo ejemplo que vimos ahí y de hecho de dhul publique un 12 de unos conjuntos de descriptores existe de inversión 128 eran sacados de unos vídeos desde ejemplo y he aquí el relación que tenía de ejemplo era de 5.000 descriptores cif y 100.000 descriptores de consulta y si programó un escã lineal aquí usamos una librería aquí está bueno si quiere manejar mejor grandes olvidos pero aquí está aquí si una escala lineal y el skal lineal para comparar para cada uno asociado con su más cercano que en total serían 50 millones de distancia de distancias en éste no 500 millones de distancias en esta comparación hace unos minutos lo que le hice a moreau 45 46 segundos y eso si lo dividimos nos da una tasa de 10 millones de los casi 11 millones de distancias por segundo nada para un computador tú no tú no normal entonces eso nos da eso nos da una estimación de qué tan grande es comparar todo esto de hecho si esto lo dividimos entonces esta comparación los dividimos y podemos ir a 10 a 10 millones de millones de distancias por segundo y sabemos cuántos tomaría esta búsqueda dividimos los millones son 10 millones y quien en realidad es tan fácil nokia por 400 mil unos 400.000 segundos segundo de choque y esto nos daría entonces para unos supuestos no supuestos razonable entonces no nos diría que en la comparación y sí que estamos hablando de extraer los descriptores locales solamente comparando de l'estació lo podrían supongamos que ya podemos hacer offline y lo hacemos antes pero en tiempo de bush que nos pasan los estos de consultas y empezó a buscar nos va a tomar el mismo tiempo que los vídeos como que no hay mucho nos gustaría ir más rápido 10 millones de instancias nos da como cuatro días que bueno y muy parecido a las camas y original de los vídeos así que aquí estamos diciendo que son imágenes de consulta si quisiéramos solamente una imagen de consulta ahí nos demoraríamos claro 0,4 días y medio día para buscar un frente y así que además eso que hay que calcular los dos ramas exitosas cosas teatro nos dice que esto está como lento bien lo podríamos hacer mejor no siguiendo con la línea desde cuando el agua de pensamiento que qué tal si usamos búsqueda recuperado y aplicamos lo que aprendimos hace hace algunas semanas atrás entonces supongamos que calculamos todos los descriptores is y bueno eso que se llama si queremos buscar un conjunto de vídeos tenemos que mirar lo primero es como lo miramos los guardamos y después la búsqueda de información entonces la fase de escritorio y vamos construir un índice con todos los descriptores y la fase online lo que vamos a hacer que calculamos descriptor ya la consulta es decir tenemos tenemos el vídeo todas las horas de vídeos sacamos los quiz 30 a los 200.000 que frente dijimos allí y después calculamos los escritores locales y eso vamos a demorar harto pero una vez llegamos a dar un par de días probablemente pero lo dejamos guardado y calculamos un gran el árbol kale trío khamis trío localización las cosas que vimos hace una semana atrás y luego en la fase online nos dicen lo que busca este objeto nos dan los objetos de consulta calculamos sus descriptores locales y para cada escritor local vamos a buscar en todo usando el árbol buscamos en todos los cientos de horas dos cientos de horas pero de inmediato el enfoque se abra cada descriptor vamos a hacer las búsquedas aproximadas pero esas busquen aproximada nuestra importan sino que sobre todos los frentes y ya vimos que uno puede ir bastante más rápido y entonces y luego para cada gestor si es de consulta vamos a buscar y nos van a aparecer los más parecidos como alguna vez que precise varios descriptores si depende de cuánto alcalde nuestro cada nn pero aquí digamos que este es un cama o menos grande pero no sé más cien o mil nada porque él probablemente objeto aparecer en varias partes entonces lo que busca y eso lo hacemos para cada uno de los descriptores locales dentro de todo el james bond y va a ir apareciendo de escritores locales en varios frentes y después tenemos que hacer una especie de votación para encontrar los frames en los mejores candidatos de hecho eso les ofrece aquí este un frente ejemplo de alguna vez el mismo algunas partes esta cosa de la próxima para que cada vez de 2013 fue después apareció el capaces de extender se requieran vídeos una voz y el nombre está tras esperar vídeos como grabados recibidos personales y aquí había que buscar los únicos avances aquí hacia una búsqueda próxima da iban apareciendo frames candidatos y después uno tiene que unos reportes de otros candidatos o uno tiene que hacer la etapa de 40 espacial con ramsés y todas esas cosas creo que cuanto sería para hagamos hagamos las próximas cultivamos con los mismos números que tan rápido iría aquí entonces teníamos del orden de 10.000 descriptores de consulta y para cada uno tenemos que comparar ahora vamos a crear un índice durante unos 200.000 que frames dice fresco son que frames y 2000 2000 escritores por por frame y entonces tenemos un bajo creará un índice del tamaño de tenemos que hacer 10.000 búsqueda aproximadas sobre todo sobre 3 sobre 400 millones de habitantes y eso significa que tenemos que crear uno o más árboles sobre 400 millones de vectores ella sólo factible en 400 millones de lectores de cómo será posible si fuera posible la buscaría muy rápido pero 400 millones de vectores son 200 gigas sólo los sólo los vectores es cierto porque cada victoria un vector de animación 128 con x 46 ya que son flores así que esperamos 512 bytes por vector con 400 millones qué es lo más feo de todo es que hay que calcular lo que el índice está memoria así que primero en disco cauca procesamos todos los frentes y los guardamos dispone el problema de 200 gigas pero cargarlos en memoria a 200 gb de ram [Música] se puede se puede pero ya no es el nivel de color de casa en así que eso estaba como difícil y de hecho cuando lo hicimos como la iglesia participando esta conferencia de casi casi de año atrás y la búsqueda la hicimos usando y distribuyendo entre varios computadores con todos estaban inaugurando el chino una máquina de cómputo con un clúster el clúster más grande de esa época desde sudamérica y tu emoción está en búsqueda y participamos haciendo esa búsqueda aproximadas pero distribuidas y bueno resulta ser que se puede y bueno y contra esta búsqueda finalmente y de obtener los candidatos los mejores candidato un número un número por definir y eso pasa no uno lo reporte inmediato o pasan a la segunda etapa de otra etapa de d guerra hashtag y esas cosas pero en estos números que uno lo manejó como brian razonable y pero todas las pocas acciones búsqueda próximamente el tiempo aquí es interesante el cuento no irá más rápido con tu temor a una búsqueda porque al igual son hartos millones de vectores de dique y que las búsquedas son rápidas pero tampoco al menos nunca de tripp de hecho aquí aquí con comparando con un k de trip y aquí tengo el mismo código siempre tiene más unas semanas atrás haciendo una búsqueda aproximada con un cadete y sol éste mismo para hacer pequeñas y que quieran de indexando cien mil vectores y aquí la búsqueda comparar la escala lineal en este caso para los descriptores si uno podría ir a mantener un 95 por ciento del mismo resultado de búsqueda en un tiempo de en este caso los 10 se demoraba 46 segundos se pueden demorar unos segundos medio segundo decir un 11 por ciento de lo que se llamaba el scan lineal no quiero comparar los contratos usando un algoritmo que aproxima ya si quiere saber más detalles de esto el régimen de los vinos que están desde hace algunas semanas atrás pero podemos demorar un 1% entonces lo que antes nos demoraba cuanto más demorará en esta línea 112 horas podríamos podríamos decir que podríamos demorarnos una hora una hora pues bien la próxima podríamos demorar una hora si es que todo fuera en realidad estos 200 están [Música] así que necesitamos como podríamos hacerlo para irte para ir a exterior diversidad pero ojalá más rápido del congo con menos uso de la marihuana uno es tratar de disminuir estos 512 bytes por d escriptors que sea esa otra cosa también hemos visto pero esta técnica que es la que tiene ahora