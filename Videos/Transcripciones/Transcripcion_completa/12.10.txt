12.10-Uso de CNN en Keras
https://www.youtube.com/watch?v=bEFHsMcOSHQ
 en este vídeo vamos a ver cómo usar las redes convencionales para calcular descriptores usando quieras en el vídeo anterior lo vimos usando ofrecer y ahora vamos a hacer algo parecido pero usando el interfaz de quieras para aquí pero poder ejecutar todo este código fuente es aquí crear un ambiente en python 3.7 por defecto y tengan un país tensor flow y quieras a la librería y luego es necesario para mí una imagen digamos para poder procesar y procesar una imagen y sí que tiene una buena gente también [Música] emocional bien entonces lo que vamos a varias redes pre entrenadas y la misma y se descargan unos 350 de 50 cajas aquí lo descargamos le decimos que tiene una red de 50 de los pesos pesados de la descarga entonces que esto va a ser rápido si es que lo hacen es aquí va a empezar a descargar de varios mb 37 pesos y lo deja en un temporal cosas cambien y aquí llamamos al sumar y nos dice en la arquitectura de la red y aquí va a decir la capa de impuestos aquí espero de los 24 puntos 24 y aquí bueno aquí vienen todas las convulsiones y toda la arquitectura y lo de todas las conclusiones que estiraba sus viviendas con volución uno hasta cinco y después vienen la cámara final de la obra exponen y prohibidas y el output son mil ya no está aquí este y la previa la de mil es de 2048 y entonces que esta capa de aquí es la de escritor con imagen en total esta red tiene 25 millones de parámetros lo que significa que es machine de lexnet en cruciales de palabras y el resultado al menos la competencia imagínate mejor y entonces como se usa en quieras aquí a la descargamos y para usarla lo que hay que hacer es que vamos a hablar por las mismas imágenes del día anterior y para procesarla la red lo que vamos a hacer que cada una de estas imágenes en forma independiente y las vamos a cargar le decimos que bien tiene 224 puntos 24 y aquí quieras darle de una función de procesamiento y específico para la rsnc qué hace el procesamiento de la misma forma de cómo lo hizo para entrenar por ejemplo en la resta de la media la imagen mediante aquí no nos preocupamos del promedio ni restarlo porque sólo aceptamos estas funciones y la imagen en la imagen aquí se convierte a una raíz con un trazo esta función de acá a continuación estamos creando un bloque espera como input la red es una raíz de imágenes de cómo tenemos una sola tengo que agregar una dimensión extra vacía y luego y eso lo que hacemos prende y nos va a dar una serie al final y así lo tomamos como hace una rey de salidas retomamos la univer del sector de probabilidades de mil dimensiones idénticos al anterior y por tanto vamos a usar la misma función del ejemplo de clase b para imprimir sus probabilidades [Música] y entonces vamos a evaluarlo y nos va a dar ahora en esta salida sobre la renta de 50 entonces todo es un avión el gato egipcio o lince las porquerías de hecho pudieron irse de aquí el paso de perro vive en el estrecho aquí estar seguro 100 por ciento y los de obtención por ciento el 98 por ciento seguro que es policía y eso los resultados técnicos pero si vamos aquí en nuestros subtemas locales en nuestro camión chileno es lo reconoce bien como un hispano es el máximo pero como está la duda así que un prisma o un vehículo recreacional las mismas se para gestionar recreacionales en este mismo quizá él es una escultura aquí está ahí la facultad y que lo reconoce como un poco más atrás uno un ser humano le llama uno [Música] una nube de la mascarilla seguro que estuve un pañal nuestra empanada se lo conoce como un un paquete como un frase de un 15% [Música] como hijas dra y uno nuestro cóndor aseguró que es el asignado americana y lo que vamos a ver es need de h es lo mismo excepto que ahora está está esta red es tiene más capaz y con 50 y la cantidad para autos son 60 millones de parámetros y su forma de gusto es lo mismo y lo usamos las funciones y vamos a ver qué es lo quiere lo que dice que se abre todo igual el registro aquí y aquí ya se decidió por otra razón también el nuestro ahora [Música] y la escultura así que si sigue siendo una duda de la mascarilla 50% de que españa la empanada ahora ahora cree que es caracola y el cóndor de una gráfica ahora como como extraemos y descriptores de esto de escritores y vamos a crear una función que va a recibir una red de nombres de imágenes y le iba a retornar todos sus equipos para hacerlo un conjunto entonces vamos a calcular los 10 features a una lista imágenes y vamos a calcular las imágenes vamos a cargar una red desde aquí en la parte interesante quieras quien quiera uno puede decir es cargado a la red y no pensé bbva estaba decir que le hiciera forward hasta siempre a cabo no aquí y aquí hay que crear una red distinta a la que teníamos antes donde uno le dice que cargue la misma red entrenada para kinect pero lo que queremos es que no incluya es la capacidad ya y por tanto se va a quedar con la última y quien esa última uno puede tomar un pool ir al final y de esto la definición digital del driver exponen a los mencionamos aquí barrios cuando vimos la arquitectura uno podría reemplazarlo por otro tipo de bullying pero el mismo desacato entonces cargó una red especial para extraer en el pitcher i luego la imagen por imagen cargando la procesándola en el proceso de las redes net vamos a crear una raíz de imágenes de una lista analista de paita y luego un país tiene la función en que le pasamos a una lista de imágenes una lista de excavar una lista de razones de récord de nada y va a crear el tensor de cuatro manzanas cuanto más bueno [Música] y esa y este caso entonces tan todas las imágenes en comunicó en un único el input en única única matriz o tensor de cuatro dimensiones y todo eso lo hice predict a la función y predicado nuestra red y la salida auditor aquí uno tiene el bache 610 que ofrecen muchas bueno y este vector de salida entonces es el vector es de con todos los descriptores por como fila uno por cada imagen y como mismos anteriores y normalizados para para compararlos nos vamos normalizar y eso significa que vamos a dividir esa matriz de normalizado por fila y la forma una forma de hacerlo de aquí cuando un país vamos a llamar en la norma pongo a circular la norma por fila y eso se la vamos a dividir a cada uno de macías y bueno sería sólo una línea hay time imagino dejaba para para hacer eso y esencialmente equipos calcula la norma por salida pues por elegir calcular la norma agrupándose en la segunda por de magia son las columnas y con este parámetro el truco de que hace que después de esta división largas bien para dividir por filas y ahora va a retornar una red de descriptores normalizados y aquí lo que vamos a hacer es que vamos a ir 111 puedo calcular todos contra todos y vamos a comparar el nacimiento con 0 porque las invito a cuestionar una legislación que ya no porque es lo mismo esa raíz cuadrada que hemos visto bien es porque la juventud con su sabor eficiencia porque 1.1 de hecho aquí estamos en el producto punto fila por fila engañará más fácil lo más directo hacia el producto de la matriz consigo mismo [Música] no sé si va a calcular los descriptores para que la imagen es encargar la red cuatro segundos y llevarlo a las tres imágenes se demoró 30 segundos porque todo que aquí está en cero así como de un segundo por imagen cuando no está con una gpu bueno esto va del orden de 150 imágenes por segundo en 2050 imaginas dependiendo el giro así que bastante más rápido 20 o más tantos segundos y calculamos entonces la distancia entre estas tres y usando la red net 152 la similitud aquí dice que es entonces la foto del gato negro es más similar que el avión contra el gato y la contralto entonces la forma en que vamos a usarlas para calcular descriptores de las etts