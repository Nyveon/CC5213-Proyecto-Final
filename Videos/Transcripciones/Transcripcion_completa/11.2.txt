11.2-Búsqueda de objetos en videos con Bag-of-Visual-Words (BoVW)
https://www.youtube.com/watch?v=ObiuLQpt5Oo
 y otra forma de buscar objetos sería a través de lo que se llaman las palabras visuales la idea aquí el concepto trata de que si es como estamos buscando objetos dentro de un vídeo y primero tenemos que vamos a estar todo el vídeo vamos a calcular los descriptores locales y si es que hay varias veces aparecen los mismos objetos que entonces tienen que repetirse muchos descriptores locales de hecho entonces si tenemos un vídeo un vídeo largo y tenemos muchos frames y sacamos aquí vamos a ir sacando los frames entonces tenemos aquí de como hablábamos antes eran unos 200.000 frames y a cada uno vamos calcular de que precise y si quieres un mismo objeto desde aquí aquí aparece supongamos que tenemos un mismo objeto que aparece en el vídeo varias personas aquí el reciente vídeo aquí y aquí aparece para caber subraya cuando calculamos escritores locales el mismo los descriptores locales de este mismo objeto se van a ir calculando iban apareciendo cosas como éstas acá para cada uno de estos tubos se calcula un descriptor shift entonces la imagen no son escritos que son varios intereses pero muy parecidos entre sí lo que están describiendo una zona visualmente muy parecida y de esto vamos a tener varios de estas de estas zonas y aquí está un ejemplo que sale donde presentar esta técnica que es un paper de decir y quise ser van desde hace tiempo he hecho un poco después de la técnica pero locales este sector es bien importante porque presenta el título web donde presenta siete paso muy importante porque impacta a muchos años de investigación este paper se observan de cindy sherman o bien presentan que la idea para escalar al ir al siguiente nivel de la compra la imagen con imágenes o quien buscar eficientemente en vídeos es la clave es hacer casting y la idea aquí es que vamos a hacer estos escritores y si hacemos clustering podemos calcular como un centro en el que así como el descriptor el descriptor shift promedio digamos de todos estos dãas y éste voy a hacer todo entonces tiene conversión de uno y aquí vamos a tener alrededor de cuatro y la idea ahora es que si tenemos diez población con todos los posibles descriptores aquí vamos a estar el vídeo y vamos que el vuelo en casting sobre todos los descriptores de que existe dentro de que sacamos del vídeo y la idea es que después cuando viene un frame y viene y viene en una escena y salen muchos de escritores locales y vamos a tener entonces mucho un conjunto de escritos locales para describir el frente y eso ahora lo que vamos a hacer que lo vamos a reemplazar por los centrales y decimos el primero abre el centro en 10 y éste quiere el centelles incluirá otro 63 y en otros centros de 4 y eso es clave porque ahora no vamos a ocupar 512 bytes las 128 dimensiones para un descriptor que en realidad esto es todo el mismo escritorio entonces ahora un descriptor un frame se le calculan títulos locales pero luego se redondean a su centro de eso y eso es como todo el conjunto de palabras que sean las palabras visuales porque porque es todo lo posible de representar gráficamente aquí estos tubos que todos es este el espacio de descriptores y está el espacio a 128 dimensiones entonces cada uno estos puntitos azules de zoom es imposible entonces todos los puntos azules son todos los descriptores del vídeo en principio y vamos a calcular y si calculamos un casting de esto en los que están en los que están ahí marcados los puntos naranjos esos son los centrales y estos puestos centrales forman en verde entonces estos forman el lo que se llama el vocabulario visual vocabulario visual porque porque ahora viene cuando venga un frame entonces vamos a calcular un frame y viene con la escena cada uno de estos acá este escritor de aquí el psuv aunque jett corresponde y este se va a redondear el descriptor local a su centro de más alcance y el otro de escritor quien va a ser quien puede que sea este se redondea a su más cerca y entonces él la imagen para cada uno de los que ustedes locales vais diciendo esto tenían letras entonces esto va a ser éste el descriptor me gustaría estar acá el descriptor greg j y aquí va a estar el descriptor que son los códigos de vicens trade ahora una imagen es solamente va a ser una lista de los centros de moda y el equipo en la posición interesante saber la posición xy pero no no no hay un descriptor de más a 128 solamente un código y eso es lo que hay que tener ojo porque él hay un redondeo y de hecho estaba mostrando de analizando es que hay por ejemplo este amarillo se redondea alberdi no está bien pero esto da acá se redondea su más cercano es ibarra donde iba a ser tal y tal también tras ese diamante esta letra c como espero que como algún otro entonces el hilo que muestra en este paper que esto se puede hacer mejor no los más cercanos ya que podemos condenar nuestros progresistas en este taller [Música] pero aquí el de éste el punto de quién vamos a ir redondeando al menos lo que le interesa es que si redondeamos ya no tenemos un conjunto continuo de descriptores y que tiene un conjunto discreto y eso es lo que nos va a dar la eficiencia entonces lo que vamos hacer que vamos a redondear los descriptores convertimos el espacio continuo a una cantidad discreta finita que nos que es el cap y que el vocabulario visual que es el cada quien el número de centrales de entonces yo que calcular y ese lugar centro de lo que se llama el vocabulario visual y bueno vamos nos bajará estatura se llevaría el vocabulario visual y que creemos que hacer un casting de muchos vectores de 400 millones de lectores como decíamos antes de 400 millones y ahí el único algoritmo factible es un game perfecto cummings gaming porque porque él no podemos un algoritmo del operativo al máximo el que eso funciona un par de miles de descriptores ya los ya son cúbico así que eso no la escala que me hicieron que se puede manejar ahora igual tres cientos de millones de lectores no se puede tampoco y lo que hay que hacer es que en realidad se hace sólo un subconjunto de un sanatorio y sólo lo más representativo posible de todos los vectores y sobre eso se calcula un vocabulario visual y luego hay que presentar todo el vídeo social de ahí se calculan todos los escritores locales de todos los frentes y se van redondeando a su a su palabra visual y entonces se reemplaza a cada escritor local pues la palabra y el tamaño se está es clave ojalá que sea en principio lo más grande posible mientras más grande volviendo a que el gráfico que tenemos acá en la figura mientras más centro jdd es vayan menor error de redondeo que van apareciendo más zonas y entonces forzosamente el error disminuye así que eso es mucho mejor ahora si tenemos demasiados androides claro si éramos tantos entonces como vectores by redondeo y no hay eficiencia entonces tienen que ser menos ahora que tanto que cuál un buen tamaño la verdad que al menos para esta técnica como la estamos sentando ahora es lo más grande posible de hecho o quizás el criterio sería antes de fidel el codo más que para electores uno más fácil hacia paraná vectores calculé rey de dimensiones y porque en realidad la razón de una razón tiene que dar como bonito porque quedar ahí tienes androides y casi androides en promedio debido de quedar con rey de reyes de m datos asociados entonces vectores como a raíz de entonces tenemos 100 vectores calculamos 10 strikes y en promedio para quedar 10 vectores en cada clase y de hecho ahora con 400 millones de vectores nos van a quedar 20 mil clusters de ahí eso como acto usando tanto eso no es factible de hacer un casting pero sí ojalá acercarse los bloques y prueba aquí de los de miles de mil o dos mil [Música] e por otra parte escritores muy grandes influye en que vamos a tener necesitar mucha memoria para mantener todos los dos centrales en memoria y después los dos venimos de búsqueda también se hace más difícil vídeos mucho más opciones de alimentos no se acumule al menos como cuando pasa con búsquedas de texto de texto esta técnica se llama la técnica del barbón michelle works vamos visual words hay que abordarse también un par de semanas hablamos sobre texto y el texto del texto se habla de lo que se llama el bajo corts de aportes que uno tiene es que tiene un documento con palabras calculamos un descriptor que representa estas palabras y representa todo el documento como un escritor global y es el escritor global en lo que hace es que va a ir tomando todas las palabras distintas y calculamos una es el programa de palabras entonces aquí está la palabra ola y calculamos el por la relevancia de cada palabra del vocabulario para cada documento de texto ya está esa misma idea es lo que vamos a hacer ahora es sobre un vídeo de hecho un vídeo sobre un vídeo ahora tenemos los frames o como los documentos y el vídeo es como el placer entonces ahora vamos a tener muchos de escritores locales donde como los vamos a ir redondeando reales vamos a tener como letras los códigos el psn el l etcétera y todos los las palabras visiones que van apareciendo y para cada uno de ellos vamos a calcular un vector que es el mismo vector ramón words pero ahora son los words ahora son los centrales que eran las palabras visuales words y de hecho cuando vimos cuando abrimos aquí bajo words vimos que en realidad histograma palabra no funciona muy bien porque porque palabras hay palabras que aparecen en todos los documentos en todos los artículos de las las proposiciones y hay palabras que y que tienen justamente una frecuencia muy alta y que eso nos va a igualar el vector esto sea y dijimos que en las obras quiera ver los videos la técnica se llama df y def pero es igual para veces aparece pero si se pondera poner y el inverse tomen frequency el y df y la idea es que las palabras que aparecen en muchos documentos el ruido de ahí se descarte exactamente lo mismo que va a pasar en un frente sí que sí que hay muchos descriptores del demasiado el pavimento de una calle va a aparecer en muchos vídeos de muchos frentes y eso si calculamos el ine es decir en cuántos frames aparece este centro hoy de esta palabra visual va a aparecer en muchos frentes y eso nos dice que este ruido y que no nos sirve nos interesan los descriptores los ryan los centros para visuales que aparecen en pocos frentes [Música] y eso es lo que se define pero aplicado ahora sobre el visor waits entonces lo que vamos a ver que vamos a calcular de un descriptor global por frente ya que es esta agregación de las palabras visuales y bueno ya esto se llama el barómetro words aquí lo clave es que el cómo vamos a hacer un redondeo de lo que esperas y ahora tenemos una lista de ves que me descentró y de códigos de códigos y podemos hacer una búsqueda en las mismas búsquedas como así de industria es como cuando uno busca texto de escritor efe el pequeño recuerdo de cuando hablábamos de texto del fide efe eran dos factores el df que esther frequency esto es el peso de la puede tener un vector van a haber muchos muchas palabras visuales vamos a calcular un vector que es del tamaño que del largo del vocabulario visual y con el importe con el peso de cada palabra visual en cada frame y cuál es el peso esther frequency dice hay que hacer un conteo de cuántas veces apareció esa palabra visual en este frente importantes y es que el frame el a apareció 10 veces entonces estos días y calculamos el logaritmo de eso y porque era el logaritmo por la misma razón esto que hay algunas que aparecen demasiado y no queremos darle toda la importancia que aparece varias veces es importante pero no tanto tampoco porque de repente árboles que aparecen demasiado entonces el logaritmo ahí lo que hace es darle más importancia pero no tanto no tanto nos interesa si es que es como el orden de magnitud de cuántas veces aparecen 10 100 o miles son 123 es así y lo otro es el perfecto y de efecto que se calcula como el número de imágenes de la proyección por número de frames y este es el número del en su y es el número imágenes donde aparece la palabra de visual pib y la idea es que si tenemos una palabra visual que aparece en muchos frentes algo cercano al número total de frames es el logaritmo nos va a quedar cercano a 1 y por tanto nos va a dar ser un factor cero y es como que estamos diciendo que esta palabra visual ya ruiz en que aparecen pocos y siete y es cercano a uno el mínimo y nos va a quedar un logaritmo denigrantes como la frente y por tanto el elevado de un peso más alto la palabra mientras palabra visual aparezca por la sorpresa más y eso es el df pero ahora este fin de efe pero aplicado en lo mismo de texto pero ahora en vez de documentos sean imágenes y en vez de palabras o palabras visuales y como buscamos con estos vectores para corts es que ahora tengo que calcular el vector de deficiencia la construcción es decir bueno hasta ahora hasta ahora que lo que tenemos tenemos muchos frames y para cada uno tenemos sacamos los frames para cada uno vamos a calcular un vector de f con el resumen de las palabras visuales que contiene cada frame e incluso sólo podemos dibujar así como una matriz de escritores de animación acá y aquí tenemos los frames los que friends y para el vector de consulta cuando el vector de consulta vamos a calcular su vector su vector te define de que también vamos a calcular descriptores locales los centro y en las palabras visuales y llegamos al vector de fdf y lo que tenemos que hacer es lo vivo que hicimos cuando lo vimos de texto calculamos las 50 y que si los vectores están normalizados eso es únicamente multiplicar rectores y de hecho esto lo ponemos como cátedra otras puesto aquí y lo multiplicamos por la matriz y nos van a dar las indycar acá en que el nacimiento costero bueno cuando los mismos contexto y la principal razón de similitud con cero es la eficiencia porque hacer esta multiplicación es muy breve y que además reconvertir me estás utilizando una fórmula que ver entonces eso es para buscar pero ojo aquí estamos buscando si deseamos siempre tocó hace no estamos buscando friends estamos comparando escritores globales y por tanto estamos buscando frames parecidos sabemos que es una parcial de un trozo del frente el frame presa es muy distinto pero hay una parte donde está el objeto que buscamos y entonces para circuito parcial lo tenemos que hacer es buscar coincidencias solamente y no no no es la similitud con cero sino que tenemos que buscar cuál es la cantidad de match de match es entre el escribiente palabras visuales y luego asegurar varias espaciales me para y para buscar entonces de frente dentro para buscar objetos entonces para buscar objetos lo que tenemos que hacer podemos invertir el índice invertido aquí que es un indicio vertido de texto en un documento un documento contiene palabras invertido es son las palabras que contienen documentos pero horas de estas son palabras visuales entonces lo que vamos a hacer es que vamos a tener el líder del centro hoy de estos son los centrales las androide y en realidad siento y destacar y vamos a decir en todos los frentes en que aparece es android y esto lo pre calculamos cuando procesamos todo el vídeo y vamos a calcularlo de jamendo moore y este el índice de box y por tanto vamos a saber que si tenemos todo el vídeo y tenemos frames aquí la palabra visual cero apareció en este tren de acá la palabra visual 1 apareció aquí aquí [Música] entonces se ve que es en línea es que vamos a tener un váter pre calculada la posición y los frentes en que aparecen cada una de las palabras visuales beat un indicio vertido que lo mismo que se hace para buscar texto y lo y porque eso son idea porque ahora en la fase de búsqueda cuando nos digan donde aparece este objeto de una imagen de consulta vamos a saber que el carbón centro en locales las palabras visuales y ahora está de aquí entonces iba hasta la palabra visual 3 con el 3 vamos a ir acá y ya sabemos dónde donde donde aparece la palabra visual 3 y luego y ahora 4 955 o entramos y aquí nos van a decir los frames y aquí va a ir haciendo otros y van a ir apareciendo los donde probablemente esté el objeto es donde hayan valles más coincidencias de palabras visuales entonces aquí en dependiendo de las listas que fuimos recuperando vamos a ir haciendo intersecciones entre ellas y una votación para ver el frame que más se repite y con eso se ve que no calculamos ninguna distancia liviana ni nada solamente hacer intersecciones y bueno aquí no no aparece ninguno pero podría aparecer a nuestro pib a ver [Música] no no veo ninguno el 22 hasta el 6 54 este repetitivas y si es que alguno alguna te aparecen varias de estas palabras visuales se van a ir acumulando y van a ir apareciendo los frames con más repeticiones entonces para el conjunto de la consulta vamos a ver rápidamente los frames con más intersecciones y ahora eso que hacemos conoce con más de sección los reportados de inmediato de hecho puede ser pero nos falta la etapa de incoherencia visual que es el rap bien entonces eso se llama la apariencia espacial y sí que hacemos coherencia espacial y podemos usar razas pero lanza forzosamente necesitamos empezar a hacer pruebas y errores por cada dos los tres candidatos y vamos a perder toda la eficiencia que estaba logrando con el índice invertido entonces podemos hacer esto mismo pero recalculando información y aquí en el pecho en el paper hoy desde bengasi creo que es dicen que tal si es aquí en el índice invertido pre calculamos información porque aquí cuando dice aparece el 31 en el frame 22 eso porque si vamos a ir al vídeo y x 322 392 estaba apareció el tribuno 11 pero podría precipitar nuestra valor avisó al 4 y destaca pero podríamos calcular un poco más de información y decir que porque la palabra de salud no podría haber aparecido varias veces y lo que vamos a hacer es que además vamos a decir cuáles son sus en qué contexto apareció no es la posición x dentro el frame sino que la posición de otros nosotros otras palabras otra palabra visuales cercanas tipo este hasta el 1 aquí está el 1 pero acá al lado estaba la 5 y lo que vamos a hacer que el próximo al calado hasta las 5 las 7 y las 10 y en este primero de acá al lado estaba la dieta y la 8 y la 5 y de este frame 4 al lado estaba y calculamos por ejemplo lo que te dibujaron hizo los tres vecinos las tres palabras visuales que aparecen más cerca dentro de cada ocurrencia es lo que hay que hacer aquí es que estas tres 22 le agregamos a las palabras visuales cercanas en cada uno de la lista de ocurrencias y por qué y eso es interesante o sos buena idea porque porque el gente consulta si es que el fin de consulta tiene la palabra visual uno va a coincidir pero en la imagen de consulta también podemos calcular y cuáles son sus más cercanos entonces del freno uno aquí apareció con el del 7 el 9 y el 2 como los más cercanos del 1 entonces cuando vamos buscando al 1 y además de decir los frames donde aparece no interesa ver los que vayan coincidiendo en sus más cercanos porque esos son no es sólo una coincidencia lo que estamos haciendo coincidencia de sus vecinos también porque vemos que está buscando el objeto el objeto no es son un descriptor visual son una nube de descriptores visuales que tienen que coincidir entonces y aquí estamos haciendo esa coherencia espacial pero rápidamente nos mantenemos en las intersecciones de aquí vais a nuevas secciones que solamente intersecciones y más estas secciones con más votaciones y porque está todo calculado hasta para calcular las ocurrencias un poco de su virtud y desde su vecindad para guardar la ubicación relativa entre palabras visuales de tu mismo frame y guardar las palabras visuales cercanas espacialmente de tales frame y en la imagen de consulta calculamos también sus palabras visuales cercanas espacialmente y vamos a favorecer buenos hombres en un en la práctica en realidad de hacer vacaciones votación y ver quién tiene votos más ponderadas dependiendo cuántos vecinos coinciden y los que obtengan un mayor es correr son mejores candidatos y eso lo que reportaba y nos ahorramos el paso de razak [Música] de esto aquí lo que reportan está aquí estos dos frentes de la misma y están buscando en donde aparece este esto como un graffiti es el objeto consorte y ver que hay entre estos dos frentes en muchas palabras visuales esto que están líneas son están uniendo palabras visuales está en la uno y explícame la mención a uno a uno iban apareciendo intersecciones de palabras visuales y dice pero así es que aplicamos corriente espacial precalculados ni siquiera es de inmediato si terminas aprovechamos decir que esta película es muy interesante para trabajar con ella esta película se llama corre lola corre round una rama después de la película interesante lo que aparece la misma escena va pasando cosa y en la misma la misma que en la misma historia que iba repitiéndose pero con cambiado es como el efecto ánimo se ha cambiado cambia un detalle y la historia cambia pero se mantiene siempre es como que siempre ocurre lo mismo pero con pequeña variación entonces es el caso especial para buscar objetos porque aparecen las mismas escenas muchas veces y otra película donde también se llama el de la marmota traunstein grove un tape y también una película que aparece es la misma persona varias veces sobre el mismo día entonces a la misma escena remedia estás ahí también es un buen caso por como para buscar aparece este florero y extraer o aparecen un montón de escenas y podemos ir viendo en toda la zona donde habrá escenas [Música] de hecho está la universidad de oxford y que gustaría mostrar la ahora instalaremos del vídeo de del paper del single sistema y permitimos tiene pública hasta estas dos películas y bueno interesante pero datos anexos está publicada y porque en nuestra película nos tiene derecho a dos tiene problema y no le pusieron todos los derechos reservados a la película y cuadra de la publicaron no le pusieron la frasecita entonces no reclamaron derechos de autor y que los de allí y unas pocas películas hay un par más que son como de dominio público y que se pueden usar para investigación entonces aquí lo que lo que hacemos es que exista toda la película toma frame cualquiera y por aquí está una persona con cara no será necesariamente bien 11 toma una escena y al apretar se busca otra vez será buscado aquí está buscando esto de buscar cara estos buscar como objeto entonces realidad los objetos van a ser ojos lo que está buscando aquí de hecho funciona muy bien y un [Música] una vez y dice ese cuadro aparece [Música] vamos y lo serán y ahí se equivocó [Música] no se ve mucho en cada encuentro pero después ya encuentro músicos en el auto me interesa que se vea qué si bien falla para el auto no funciona es muy rápido es sorprendentemente rápidos como uno puedes buscar en horas de vídeo pero de inmediato que la calidad la respuesta la calidad hay que trabajarlas en el florero pero es muy cómodo ir a buscar algo establecida cuál es la clave entonces para buscar en el buscador de cuadros el vocabulario visual lo que hace así como conclusión de esto es que hacer un plan grande escritores locales es la clave para el ir rápido y hacer búsquedas muy eficientes porque porque estamos cambiando y el continuo descriptores a un conjunto de escritura se nos permite usar calcular el insee martín el índice invertido es la clave como canal beneficiar siempre y para poder ser en diciembre tiene necesitamos un vocabulario discreto de palabras no se puede hacer un índice invertido de descriptores en general porque los de distancia y nunca son iguales entre sí pero decir que los redondeamos y forzamos que se parezcan entre sí nos podemos ir acumulando y calcular un incentivo y lo más rápido que hay por qué porque en buscar colisiones solamente pero sin cultura nada y anclar y empezar a interceptar eso es como el masaje y que no hay árbol no hay caletri y no hay localizaciones así que cuenta con invertir y que el vocabulario visual este indio vocabulario visual que es clave y esto esto hizo que uno esto esto es generalizable y en vez de buscar ahora dos instancias ahora vamos a buscar y podemos usar esto mismo para editar imágenes de ahí de hecho esta forma de cómo es de buscar y representar imágenes por medio de palabras visuales marcó como una década de investigación en esta área lo que sí es que hay que decir que como se vio nadie la demora de que hicimos la caridad de heart urgencia y todo eso pasa por el principio en la cantidad de centrales y aquí está ojalá y no necesitas más centrales para evitar que redondear sea lo menor posible cuando estamos redondeando estamos agrupando cosas que son distintas diciendo que son iguales y ahí donde se hizo mucha investigación en durante desde el 2000 largo hasta 2010 2012 así hizo mucha investigación en cómo evitar el redondeo y se redondean de la verdad que se puede mejorar y no hay para quiere decir que está igual a los otros calculando distancia acumular errores calcular y subdividir o calcular y tanto que calculan vocabulario visual jerárquico con sus palabras palabras con sus palabras 'nadie investigación y muchas ideas para tratar de evitar ese error de redondeo y eso lo vamos [Música]