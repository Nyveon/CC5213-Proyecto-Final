07.3-Locality sensitive hashing (LSH)
https://www.youtube.com/watch?v=jqB8jWmIJk8
 en este vídeo vamos a hablar sobre el local y tisanas y pazzini aquí la idea es que vamos a generar proyecciones aleatorias de los datos y los vamos a mover de una asignación alta a una un espacio de la ordenación y esa función que convierte un espacio de alta dimensión a menor dimensión en la que vamos a llamar una función de hatch y vamos a hacer las búsquedas en ese espacio de menor dimensión pero él dice que la van a hacer búsqueda del vecino más cercano sino que van a hacer búsquedas de los objetos que son asignados al mismo paquete que son los objetos los cuales dio el mismo resultado la diferencia que por medio de estas tablas de gh vamos a poder hacer búsquedas de conjuntos cercanos pero que a diferencia de los árboles que vimos antes donde tenemos un parámetro que podríamos juntar yo podríamos hacer desde novo que asalta aproximaron aquí el índice mismo ya es aproximado y es que el plano del índice el índice el que contiene el nivel de aproximación una vez lista está calculado ya no hay uno no puede trabajar más para hacer un mejor resultado ya está ajustado para cierto nivel de efectividad en ese tiempo offline que se decide en el nivel de aproximación bueno es una función de hachís se dicen locales y sensitive cuando la probabilidad de colisión de dos objetos se disminuye cuando la distancia de ellos aumenta o buena noticia no en el opuesto dos objetos que están cerca su función debieron dar un valor igual o muy parecido y es por eso el nuevo funciones a que cualquiera porque en lectura en una función de heads normal si vamos a la definición de tradicional ya que aquí se ve en el vídeo de previa esto en un vídeo de explicación de las funciones de height en el repaso título gratis si calculamos una función viajar desde un número de 45 y masdar al bol aquí hay h de 46 y tiene que dar un número nada que ver con que tiene que ser totalmente distinto eso es la definición original de funciones de béjar en esta definición locales distancia tipo no es así si son dos números muy parecidos queremos que dé el mismo pero más lejanos queremos que las cosas víctimas entonces vamos vamos a usar este ese tipo de funciones y de hecho lo que es una función dejar h lo que iba a hacer es que vamos a un vector un vector desde siempre dimensionalidad y la función que va a generar un número y vamos a tener distintas funciones de hatch para él solo el mismo vector yo iba a dirigir al de tipo nombre y estos números en la proyección un espacio de menor dimensionalidad y en todos estos juntos estos números juntos que es la proyección del espacio menor de nacionalidad es esta ley es el hadj y vamos a buscar objetos que tengan el mismo hachís típico inciden en todos estos valores del espacio de donde fabrica bueno aquí lo vamos a explicar entonces lo posible probablemente pocas condiciones y vamos a ver dos enfoques el espacio de javi que es tradicional y uno más reciente quien de las pasiones criamos para los pasos de jazmín en el mismo camino de las distancias de jardín de los bits y que vamos a calcular encima lo que es la de la distancia en la distancia que dice cuántos bits distintos tienen 2 dos cadenas de bits entonces pero aquí nosotros no queremos comparar que deberíamos comprar vectores que lo que vamos a hacer es que en la forma intencional se llama usar notación un área porque la anotación un área dice es bien simple dice sí que tengo un vector que es 45 2 tengo que convertir el cuadro un cuadro se convierte en 41 el 5 se convierte en 51 y aldo se conviertan dos somos y hay que completar con ceros con el número mágico si tengo que decir que esto de aquí es máximo el sistema no será uno y tres euros y estos cinco y 20 si esperan 256 así que máximos tiene entonces estaba acá es una cadena de veintiún bits y este es el estilo de los 21 bits esa es la notación un área de ese vector es bastante ineficiente en la memoria porque si son números de 0 256 bits así que porque si no usa la meta son binarias normal la siguiente y 5 como máximo 600 de ahí tal en el 2 [Música] 5 desde el vector y se nota así y las gracias a esta anotación es que ahora sí tenemos dos vectores distintos por ejemplo el 25 y el 41 el 41 va a ser 1234 0 0 1 1 2 3 4 5 y la distancia de jazmín entre ellos dos es el número de bits distintos y entonces en esta zona que van a haber 2000 distintos que se conoce y aquí va a haber 4 [Música] en total hay seis títulos y su distancia exámenes seis que es lo mismo que la distancia de 12 y la suma de la diferencia entonces en este sumados y en estos 14 distancia 61 estacionaria mantiene esta colonia de sus amos natación de bits aquí en el 2 va a ser el 10 y el 3 200 000 y el 3 es el 0 1 1 y el 4 0 y la distancia entre primaria distancia de bits entre el 2 y el 4 está en la misma distancia con el 32 esta misma instancia desde el 4 o mejor aún siendo grandes entendemos el 7x en 111 y el otro segundo del 8 y el 80 100 son muy distintos esos son todos números en su notación de bits pero en realidad sus valores son complementos [Música] y por qué vamos a hacer estacionario porque la proyección en un espacio de menor dimensión va a ser una selección aleatoria de eso peaks porque ahora tenemos dos vectores que sus cadenas de bits y que son cercanos aparecen de 1000 bits y no queremos comparar los ministerios comparar algunos entonces que lo que va a hacer vamos comprar a lanzar un subconjunto de ellos un subconjunto de enix entonces son bilbao comparar un subconjunto de cinco para cualquier y si y si es que los vectores se parece a esos cinco bits de grandes evidente coincide como la clave 5 muy poco que hagamos varios pares de 5 pero la primera extracción de 5 la función y vamos a tener [Música] vamos a buscar los que coincidan en estos cinco versos bits sobre la colisión y porque lo que no se parece y si no se para hacer es porque el 5 y para mejorar la eficiencia algo que es de 1000 bits como en comprar sólo 5 bien entonces lo que vamos a hacer es que vamos a probar varias veces y vamos a crear el lg funcional de hanson y aquí vamos vamos a ir viendo uno de los objetos que son muy cercanos van a debieron de coincidir en varias de esta edición entonces digamos vamos a terminar 20 20 proyecciones podemos hacer unas 20 intentos de 5 bits juntos ya dentro de un conjunto ministerio de seguridad y la idea es que tiene que conseguir 5 pero lo vamos a intentar 20 veces como hacer un antiguo es un 35 típico decir siempre 5 y vamos a hacer 20 intento y equipo y siga más veces mejor en quiero ver cómo se hace esa es una tabla para buscarla para hacer la búsqueda para las búsquedas esa es la proyección en el valor de la función es el índice de altura está en el ejemplo y aquí está el ejemplo donde he sacado del libro del examen aquí tenemos conjuntos de datos donde esté el valor x del valor de cotización es dónde vamos a decir que está en el máximo es 7 el máximo 7 y por tanto la nota sol un área y tiene largos siete islas y la consciencia por dimensión y por tanto al juntarlos todos estos la anotación un área son 14 bits y el largo 14 entonces decimos que el espacio original es un espacio de 14 vivenciales y 14 dimensiones veranes y vamos a calcular en proyecciones de tamaño atrás entonces este 1 h 1 del objeto del vector el de h2 h3 h nos da entonces como h1 una función de hac es un espacio de tres dimensiones donde esas tres dimensiones eran hasta vivir de las catorce posibles son 14 y ahora ya se ha perdido la coordenada 1 coordenadas es una cadena de 14 bits y de su 14 bits vamos a 3 al azar y en las anteriores dos del móvil 3 y vamos a proyectar y vamos a tomar es los bits 2 9 y 13 de cada una de las cadenas y nos van a salir despuntar ya que son las proyecciones a un espacio de las animaciones las dimensiones finales y eso lo vamos a hacer cuatro veces porque aquí lo que vamos a buscar parecidos a los vectores que están cerca entre sí si tomamos tres al azar debieran de cualquier por ejemplo aquí es escuela coinciden s con eso del 100 entonces estos dos hay una colisión y todos son asignados al mismo paquete y este es el estante consulta vamos a buscar el vecino más cercano de cv que es el vector elemento es tropas qué tiene esta cara bits y por tanto su proyección a las dimensiones 0 1 0 y todos los que coincidan con él son candidatos a vecinos más cercanos 0 1 a 0 entonces coincide con este y años son figuras es mucho hablar solamente una que seguro que va a dar muchos falsos positivos va a encontrar condiciones donde él conociendo quiere que no se parece pero que contienen sufrir kits parecidas pero esos tres iguales entonces lo mejor es tener varias funciones castigar una función de hachís de dos con los beats 7 y 14 eso nos va a dar esto para esta carga vital min 74 entonces última vez del día y el 14 [Música] 90 100 más y ahora buscamos quien tiene el mismo valor aquí según su y bueno ya lo hablamos con el del 1 al 5 y el 11 el mal uno el primero el 1 el 5 y el 11 y ninguno y la función 410 el 82 aquí vamos a probar ahora cuál es el vecino más cercano el vecino más cercano es el que tiene el mejor candidato a quien tiene ojalá x coincida a la 4 pero consideren las cuatro en las cuatro funciones dejar es muy estricto no seríamos muy estrictos estaríamos pidiendo que fuera el mismo vecino más cercano y entonces se pide que coincidan en la posible coincidencia podemos hacer como la distancia la cantidad de colisiones que tiene con un máximo de el l el parámetro que vamos a ver el que coincida en más de ellas y en este caso si lo vemos dos veces una vez de una sino tres veces es el que vamos a decir acerca y eso coincide tanto porque sus cadenas de bits se van a ese entonces para distintas predicciones coincide y efectivamente el 0-3 y bueno aquí está el ejemplo d estos son los mismos vectores artes donde están de aquí son las condiciones los bonos muestran las veces que lo exiliaron los aquí está el 3 y al que elegimos sólo quieran más cercanos cualquier el vector de consulta con siglos atrás gracias concreta de invertir en amsterdam y aquí había otro que coincidió sólo dos veces quiera y esta zona de la tabla dice las distancias y ahí uno puede ver entonces que la distancia el vector con más condiciones renal quien tenía el mediante unas décimas en cada estación eso es el espacio es el método de búsqueda y que cualquiera que es este ejemplo que hicimos acá tiene dos parámetros m igual 3 m chica igual 3 qué significa eso esto es la imponente el de los los bienes para entender 3 dice es el tamaño de proyección al espacio una menor dimensión alidad entonces algo que la dimensión 14 en este caso 14 bits 14 bits se va a reducir algo de diversión tres hilos decir más cercanos tienen que coincidir en es en esas tres dimensiones en ese espacio de la ordenación tiene que haber una posición para que la presión tiene que coincidir en nuestro al mismo tiempo [Música] y luego el número de intentos que vamos a hacer y el vecino más cercano tiene que estar en la mayor cantidad de ellos mientras más coincida mejor y aquí transición el envío antes de que aquí todo esto tienen tres bits y el alemán 4 es porque hay cuatro tablas son tabla de hachís porque estos números que están acá si se interpretan como número binario el índice del parqué de la tabla y ahí se va a asignar que usted después dice el deber queda 0 1 a 0 este es el estado como viven en el iniciador de la tabla sub 20 y entonces cuando al reino reino también le va a ser el señor obama en esa tarde ahí vamos a sacar los cristinos lo que coinciden desde aquí no se calcula en distancia ya no no esto son solamente esto es muy rápido porque son puros intersecciones y ahora como exigirá lista de espacio y nos mal necesitamos una función de hachís que no requiera en calcular en esta anotación un área y cómo podemos hacerlo de hecho pasó bastante tiempo esto de el de los espacios deja min y los de bits de activos se conoce y pero no es muy usable y fue como al principio 2000 que ofreció una función de hurts para ese espacio que ya no es nativa de los que no pasará bueno extraordinario y eso hizo que fuera más ambiente un pote de 26 h la función mágica es placa está aquí y la de la función que calcular cuál es esa función aquí hay dos parámetros un vector es un vector el v corta es el dato el objeto que queremos indexar es un vector y vamos a calcular una proyección aleatoria a que una dirección al azar y el cuerpo que significa producto tendremos un vector del vector b y vamos a tomar al azar una dirección consideran la salsa nuestra y vamos a calcular la predicción de uno sobre los y ese es el punto nos dice qué tan cerca está [Música] y entonces vamos vamos a ir como proyectando los vectores en esta dirección luego le sumamos un b que es un número aleatorio es todo un escalar en realidad y lo otro la división por w es el número de paquetes que vamos a usar aquí en un ejemplo entonces rector requisito de los vectores digamos que aquí está el origen desde este espacio lo que hace él da una dirección al azar y es como todos los vectores que existe para que nos va a dar una moral en que se hacía antes proyectar un espacio de una asignación es lo que haces eso lo que hace el producto y lo vamos a hacer a través de lo más cierto dos veces y entonces el marketing que cae en la función uno y empaqueta y en la función dos en dos dos normales aunque todo esto alguien a 5 grados entonces este lector de aquí es el 5,2 ese es el espacio y es el espacio mlb la ordenación h entonces hd entrega un valor numérico vamos a concatenar m funciones y eso nos va a dar un jaque es decir nos va a dar como un vector del espacio medial es a donde estamos reduciendo estos vectores y por tanto lo de los vecinos más cercanos los candidatos tiene que coincidir en esas emery función se entiende que es un vecino más cercano tengo un dato y el vector de consulta es éste y vamos a dar una predicción aleatoria para acá y todos los vectores se proyectan esto está acá esto ataca y caen para caer en el mismo paquete entonces esto lo hice estos hombres sino más cercanos pero se ve que pueden incluso estar lejos de cv y ser proyectados al mismo al mismo lugar entonces eso edificar van a salir decimales así que si no me acercaron cuando gracias tan lejos esto se mejora si es que tomamos voltea proyección al azar y proyectamos todos los datos sobre esa otra dirección porque el sábado a prisión él está acá arriba que proyectaba donde mismo el q ahora cuando se tome la prisión ahora va tan lejos y los que estén los maitres que estén cerca de q de verdad tan cerca es para muchas proyecciones siempre va a parecer ser es como la idea y por eso quiero tomar vaya vaya varias proyecciones porque eso nos va a permitir mejorar la efectividad y efectivamente encontrado y vecino más cercano mientras más proyecciones en el mejor y el w luego tiene que ver con esta tabla cuántos paquetes vamos a tener ahí que es como el blog sólo que no puede ser ni muy ancho justa ni muy grande ningún chico si es muy chico entonces somos demasiado estrictos y si no desistía mostrarlas muy finas y no acumulamos nada y que en todos se van a más pero si la sangre se acumula un buen parámetro w ya que tiene el que permite acumular los mentores también que tenemos un buen parámetro m que es el número de gente claudio número de proyecciones al azar para generar un hash porque si son muchas somos demasiados y son muy pocas son todos vecinos más cercanos y el suelo empieza entonces el proyecto del espacio de dimensional a uno de diversiones y eso te son números entonces que semejantes y tienen que coincidir en en esos menores y esto mejora si es que calculamos l para manejar y vamos y hace una votación sino más cercano ojalá que coincide la gn pero podría coincidir menos incluso hacemos ahí una votación y el que tenga más inclusiva más de ahora es que importar los parámetros y el al menos al tercer los primeros y empezamos a estudiantes que precise el dato de cuántos para los dólares 700 b vean sus mezclas de nación 128 se reducen a 24 dimensiones y eso es hay que intentarlo 32 veces reportado de piper que usar esto para para descriptores sigue mi búsqueda de imágenes a cosas porque él califica así como se busca se busca y se buscan en coincidencias en el hearts completo y esos van acumulando en las generales y hay que decir que ajustar los parámetros aquí en el sh es muy difícil y es clave y es clave lograr un buen ajuste parámetros tener un buen tener un buen l [Música] sí no o sea aquí vamos a ver un ejemplo ahora con una aquí hay distintas implementaciones de la iglesia h la implementación clásica es una implementación [Música] el investigador -es implementaron externa de dos el bch y que es como la que empezó a usar a aumentar el interés y otras más y ésta no está ahí [Música] [Música] y lo vamos a probar sobre descriptores 7 de animación 128 el lo mismo del mismo de los últimos antes de 5.000 y 100.000 inventores y lo que como se inventa esto aquí a quien primero vamos a tener que calcular cuánto borrasca lineal para poder calcular la relación aquí aquí hay que saber lo que medir qué tan rápido es el índice y no saber usarla es que la línea entonces aquí está calculando la escala línea mientras calcula eso vamos a ver bien cómo se usan en el país lo que él es bastante las funciones de castilla se basa en lo que saca los miles a cada es que vamos a calcular para el data set vamos a calcular de 1 2 3 4 5 6 el l mayúscula aquí es 66 dar las tejas y cada una de esas tablas de hat van a ser 16 proyecciones el ml minúscula el 16 son 16 vectores aleatorios sobre los cuales se proyectan los datos y luego se van a crear tablas de 15 de 500 l paquetes como hay una componente aleatoria aquí a la sal se vuelve un problema empezar a probar la eficiencia porque cada experimento cosas distintas y los indicios no será lo mismo para evitar eso es una semilla y esa semilla es lo que dice es que la realidad de esta semilla cosa que se ejecutó de nuevo esto me queda al azar pero va a ser el mismo axarquía en todo esto la semilla entonces uno define esto este es el motor y ahora uno tiene que pasarle cada uno de los vectores uno de sus ciclos sobre la caseta y se guarda este vector y xl pase al aire el líder es el que va a ser el número correlativo y cuando cuando termina de calcular el índice después hay que evaluarlo como se evalúa esto es uno en el down inicial darme el nombre sino más cercanos y ese resultado es un poco inquieta y es tan rápido así que fue más rápido más lento que en escalera bueno el ska lineal aquí demoró más de dos minutos y ahora vamos con esto para nuestro cuánto demora en calcular y en construir el índice en pasar los 100.000 vectores por estar todas estas proyecciones y después viene aquí el y después lo vamos a evaluar la construcción de ese entonces todo el índice como el paso minutos y ahora lo vamos a evaluar a ver cuánto tiempo toma en ejecutar las cinco mil consultas y también tenemos que medir qué tan de respuestas correctas tienes quien tanto se parece a mí lineal se demoró en tuvo 50 por ciento de correctas a una eficiencia de un 6% y ahora es igual que espero que quiera ir un poco más rápido o quiero ir un poco más lento lo que hay que hacer es que adquirir y probar otra función de hatch y entonces aquí los experimentos tomarán todo el tomate y aquí hay que ajustar varios parámetros de una chica en minúscula el l mayúscula y en donde mes y además hay otro para otro aquí y eso lo sé uno puede en vez de gracia solamente una votación es súper rápido porque jamás calcula ninguna lista saben que esto no calcula ninguna distancia son solamente proyecciones de la función de haiti y colisiones de las partes y sumar uno puede en vez de retornar el que tenga más votación buscar el vecino más cercano sea buscar 10 y entre los 10 primeros calcular distancias liviana y efectivamente en 3 en 3 olviden calcular el vecino más cercano y es una especie entonces les gustará tales como especie de filtro y quiero entrega mucho candidato de las células sólo que los k nn hacer un carisma nn más grande y sobre esos que a prima calculan la expansión cliquear en calcular ahí los k n como si usáramos a distancia y así me dice cómo filtrar otras otras proyecciones de steve se puede probar los parámetros que decían este efecto en las 32 funciones de heart con nuestro tiempo [Música] no no hay no hay con ventaja de hecho este número que está acá 50 por ciento de precisión con el tiempo de esa línea va a tener que el caletre el cade tribuno ni siquiera eso 33 este perro y el problema es que hay que ajustarlo y encontrar un bueno para otros muy difícil hecho y lo mismo no ha podido encontrar un buen conjunto parámetro que permite a quien le saque sea competitivo con algún árbol así que espero llc active en los trabajos que logran a ajustar prometen resultados que pueden buscar en miles de millones de lectores y semana de milisegundos [Música] pero dado que el ejemplo no podía encontrar un poste y como ejercicio propuesto seguir explorar desde esta línea y ahora vamos a ver el último índice mejor