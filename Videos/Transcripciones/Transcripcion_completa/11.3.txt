11.3-Clasificación de imágenes con Bag-of-Visual-Words (BoVW)
https://www.youtube.com/watch?v=GBl-rEuOb2M
 así como los code books se pueden usar para buscar objetos en vídeos también se pueden usar para clasificar imágenes o etiquetar las primero cuál es el problema de clasificación sólo lo que tenemos en clase digamos tres clases tenemos aviones gatos y bicicletas y para cada uno tenemos imágenes de ejemplo por ejemplo aquí tenemos imágenes de ejemplo de aviones tenemos imágenes de ejemplos de gatos imágenes de ejemplos de bicicletas y aquí como decíamos cómo se ve la imagen de la bicicleta regatos y con estos datos que son de entrenamientos donde enseñamos que significa avión o cómo se ve un gato un avión o una bicicleta viene una nueva imagen desconocida y tenemos que decir qué clases cuando las veces está esta imagen que está acá es bicicleta aprendimos desde niños pero un algoritmo cómo se puede programar esto estamos pensando en esto se está tenía que empezar a desarrollarse 1 año 2005 y esta altura poco después de backovic el cuerpo y después lo que vimos de entonces de hecho hay un un desafío aquí el arte una competencia anual quiere él el chalé de clasificación de objetos y que se desarrolló anualmente y se desarrolla mucha investigación y ahí hay distintos data sets entonces cómo resolvemos esto bueno vamos a los mismos construcción cuenta que con los coches funcionaban muy bien y que lo que vamos a hacer es que porque funcionan asumiendo que cuando las imágenes son del mismo tipo por ejemplo que cuando las imágenes son de un mismo tipo y visualmente tienen que haber algo en común ya veces como escuela hipótesis o el supuesto para que todo esto funcione si vamos a ver los aviones que tiene que haber algún patrón visual común entre ellos en el caso los aviones tienen que hacer que no se está en la trasera tiene que verse en algunas en todas las fotos o las alas o esa zona como de la punta de esa como redondeadas una acción en otros no pero hay con tres patrones visuales que son comunes a la posible caso de los aviones bueno imagina siempre las fotos de esos triángulos de oreja o cola o un par de ojos y el caso de las bicicletas tienen que ser tienen que haber ruedas podría haber un caso donde una bicicleta no tenga o no se vean ruedas y me dice hay una bicicleta de insecto justo está tapado pero en general es como que es un fuerte indicador seguro de ruedas nuestros círculos de qué es lo que hay ahí es una bicicleta cierto ruedas o pedales podría ser o no el manubrio cosas de ese estilo entonces aquí vamos a ver nuestras fotos cbm y orejas ojos tiene que ser el patrón del gato cierto no coincidir es como la intuición de cómo funciona esto y cómo lo hace entonces lo que vamos a hacer es que vamos a comprar vamos a calcular escriptor en locales y vamos a calcular el vocabulario visual y el vocabulario visual y nos vamos a calcular es sobre todas las tasas de entrenamiento en esta imagen es cuando calculamos de escritores locales van a aparecer de escritores locales en esta imagen en la zona de las alas en el de la cola y en los ojos de los gatos para aparecer en las colas y en las orejas de los ojos y que van a aparecer en el sillín o en el manubrio de la bicicleta aparte de muchos otros además pero nos basta con que por lo menos salga en las zonas que nos interesan y por qué porque vamos a calcular el vocabulario visual que es todos estos descriptores vamos a calcular un clustering sobre ellos y el clusterin con una cantidad de androide ojalá grande cosa que haya como dijimos recién que haya poco redondeo y que necesariamente aquí va una palabra cuenta que es este trozo así que el pachi que es como así es va a ser muy representativo de es la clase de aviones y el pach que sea como de así es va a ser muy representativo de la clase de los de los gatos y no también sea como un parche que es algo así va a ser representativo de las bicicletas porque se repite mucho en cada agua entonces eso vamos a la imagen de entrenamiento y tiene que haber tienen que repetirse las palabras visuales por la repetición de las palabras visual nos dice qué clase es entonces para hacer eso vamos a calcular un vocabulario visual con la imagen de entrenamiento y entonces vamos al puesto estuvo sobre todo las imágenes de entrenamiento y vamos a calcular el vocabulario visual y luego con el vocabulario visual después vamos a calcular para cada imagen y el vector vago víctor works ya esencialmente lo primero la primera idea es esa después se va a ir complicando perú pero es la primera idea y lo que vamos a hacer es quien después con un clasificador un clasificador de los clásicos bien visitar neuronal y convulsionada eso sino que un clasificador como un árbol decisión por ejemplo y vamos a pasar aquí vamos quedar vectores 2 de animación principio animación acá donde estas son las palabras visuales y entonces cuando en los vectores que son de datos aquí va a ser una palabra visual que idealmente la palabra visual y la oreja de una abeja de gasto y aquí probablemente haber un peso más alto 0504 y cuando allí veamos de los aviones aquí van a aparecer o rescate gráfico mucho bien y aquí a veces más bien 0 pero aquí va a estar la palabra visual de la cola del avión y aquí en los gatos para aparecer 0 pero en los cuales había un hombre 605 la bicicleta va a haber otra visual en el clasificador él el árbol de decisiones el clasificar bayesiano en el que se va a liquidar se cuenta aquí en el conjunto de vectores de una clase de gato tiene distintas palabras visuales que quiero identifican de las otras clases que lo separan el clasificador y el clasificador va a ir probando para descubrir cuál es el patrón de las palabras visuales que identifican a cada clase y entonces vi ahora que estrenamos eso viene a una clase desconocida que calculamos su vector vamos dicho al words y el clasificador va a decir a qué clase pertenece la clase que se asemeje a su patrón de parís entonces el paso 1 a calcular el cottbus el vocabulario visual y esencialmente en principio las mismas casi sobre los descriptores locales de todas las imágenes imágenes de entrenamiento todos los ejemplos nos dieron calculados escritores locales sobre textos todas solo 'cluster' izamos ahora eso va a quedar como viene a tocar la clase esto está bien pero uno tiene esperanzas de que ojalá que fuera un precipitado un poco más general para cualquier tipo de clase y ahí es donde unos 17 qué tal si calculamos un organismo sobre imagen de entrenamiento sino qué son imágenes generales y podríamos tratar de encontrar un conjunto de imágenes un par de aviones datos bicicletas perros botellas autos casas y camiones tigre no sea cualquier cosa y si es calcular un vocabulario visual y caracterizamos todo eso y podríamos tratar de tener un poco de volar yo visual universal es como la idea del hecho esta solidez que motivó a recopilar ese vocabulario visual universal cualquier idea que motivó a besar recopilar imágenes y crear los bienes se llama el imaginar y que después resultó estar que sirvió preparado técnica que era la de las redes convencionales nada pero partido motivado por pues por esto y una vez que calculaba este vocabulario visual ahora la cultura de imagen vector algo visual words y escritores locales de la imagen usando el vocabulario visual y luego entrenamos y clasificamos entonces aquí es donde los escritores locales y en principio aquí te los doy de o entrenamos sobre todo la imagen de entrenamiento o sobre un subconjunto de ellas buscará un subconjunto representativas siendo esto tiene una asamblea un par de imágenes por clase [Música] lo otro es poblar imágenes generales y luego para hacer el algoritmo atlas string vamos nos tenemos que ajustar el número de asientos que compró como ya dijimos el artista lo más grande posible o mejor aún podemos tratar de calcular una mejor agregación de becerra donde al centro de tratar de hacer allí técnicas más de la hora hay que decir eso sí ha resultado muy interesante que cuando hablamos del algoritmo el clusterin uno podría pensar que hay que lograr el mejor traste imposible con bastante potencia y después en el trabajo de investigación se nos cuenta que la performance del clasificador era que mejoraba mientras el casting era mejor pero no mejoraba tanto aquí tenemos los vectores y sólo estábamos a las tic y el clusterin va a va a partir y va a ir sobre las necesidades distintas y va a calcular ahí los tipos de vector excepto sino en cuenta que en vez de trabajar porque lograr que converja de esto se muera muchísimo no hasta horas o días calculando entonces que son millones de electores si no cuenta que si no esperaban a que convergerá y solamente hacia en un 15 emergentes y los 10 solamente como al azar al azar solamente pero mantenemos el mismo centro pero no nos hemos que se mojaban hacia el asia las densidades y los dejamos ahí y calculamos el back office of words tienen por supuesto que es peor pero no es tanto peor y de hecho uno esperaría que mediría esto nos está representando las necesidades y lo que les comentaba pero entonces la palabra visual no es la oreja del gato ni la cola del avión y la verdad es que se nos cuenta que es bien insight de cómo funciona esto que la verdad que sólo palabras no es el punto y el punto es calcular una base común para todas las imágenes y qué por supuesto que mejor si sabes son trailers pero no tengo la referencia aquí pero moverse y reportar algo así como 2 060 sacaba lo mejor si uno lo hacía con algoritmo camino al azar eran 0 54 52 por supuesto y es por problemas en turno no no es que el hacer que converja el camino el que le da la potencia de hecho lograr unos 50 sin hacer plástico nos dice que la potencia de esto y la mayoría más actividad nos viene viene dados de esto de calcular una base común y después calcular los descriptores escribirlo en función de esta base común y esta es la clave y entonces y eso también orienta la investigación [Música] a cómo calcular estas líneas que nuestras líneas que tengo un descriptor local como lo escribo en función de esta base común entonces lo primero que hay que el primer modelo que el que ya vimos antes vamos a reemplazar cada escritor local por su palabra más cercana el redondeo el click que le llamamos antes y que el descriptor el logo visual word llamaremos un lema llamado el descriptor edwards ya que sinceramente despide efe del redondeo de cada palabra se redondea incluso ni siquiera de repente ld efe ni siquiera hay que calcularlo porque si dejamos solamente el pp prefiriendo alteza solamente porque lee de efe es más para él y df arrojó que el ide efe lo usamos antes por estado buscando objetos el mismo objeto haciendo recuperación de objetos pero con estamos de ti que tanto es la verdad es que nos interesa el objeto que se repite en realidad clasificador para ezequiel ruido así que se repite dentro de muchas clases o si es que un patrón específico de una imagen entonces de control que no queremos ser tan específicos el test [Música] y bueno lo que sí es en cuenta que mejorar es que como un bonito grama pierde la ubicación de donde establece 7 si tenemos de logias de aquí y calculamos el centro y le decimos que la palabra usa la palabra dos palabras cinco el centro de 125 esto nos va a dar un historia más pero el histograma decía que había una palabra uno arriba y no abajo ya lo mismo va a sumar uno entonces como ya como ya lo vimos por los descriptores globales al inicio el curso todo mejora si es que mantenemos un poco de la relación espacial y esta imagen la dividimos en zonas por 44 y para cada uno de ellos calculamos el vector awards por zona y entonces ahora voladora base electoral ahora va a ser de 22 pero dice pero ahí estamos que acuerdan solamente por una zona para que el objeto más grande entonces en realidad igual vamos a tener el global y ahí es donde sale y entonces agregarse tres viendo esa lista gramos por sólo por ejemplo lo que se estila en este caso es calcular 4x4 y concatenar lo con un 2 x 2 y contratarlo con 1 global de toda la imagen es decir es decir si tengo una imagen calculamos él una de cuatro por cuatro cada uno ahí estará la dimensión acá y además el de dos por dos y además el de uno por uno el histograma entonces bien tenemos 16 más 420 201 es un vector de inclinación un gran vector de 21 porque el drama de dimensiones y después del clasificador verá cuál es la resolución que les sirve cuál es la zona del vector quiere decir para identificar entonces después de la investigación también se acuerda qué los equipos no son necesarios de hecho de los trabajos que empiezan a ir mejor en la competencia bastante los que no le empiezan es mejor empezar a comparar que por ejemplo los dos detectores los equipos se van a las zonas entonces en un avión van a representar y no representar el fondo porque el fondo no hay punto interés siempre como lo hablamos cuando hablamos de punto y tres pero si no va a clasificar [Música] un avión de hecho tuvo que aunque esto no está y no sabemos que hay allí no especulamos ningún descriptor dei y esto está tapado y nos dice lo que hay aquí adentro en esta zona hay un avión o un gato o una bicicleta si se ve es una zona plana azul cielo es más lo más probable es que sea ahora ya de acierto está raro que tuviera un gato ahí es cierto entonces eso nos dice que la clase entraría al fondo si nos interesa en las zonas planas si nos dan información de la clase y tenemos que representar la exprés y calculamos que point solamente se va a ir a una partida para representar el fondo no se dice lo que necesitamos hacer no sólo equipos y vamos calcular sus platas se amplió de a suárez todo su equipo es y calculamos que point a una tasa constante a un desplazamiento constante y de hecho es rápido e incluso el son buenas noticias para la velocidad porque porque ahora no hay ningún algoritmo de detección sino que solamente calcular descriptores en todas las posibles combinaciones el tema que son malas noticias para después la memoria o el disco egipto de se empiezan a ser gigante pero muestran pruebas y así que empiezan a hacer se amplió casa o algunos que están combinando y si eso nos juntamos con las pirámides para hacer que legislan estamos recién empezamos pirámide espaciales a plagas y además hay que multiplicarlo varias veces así que nos queda una cantidad gigantes de datos pero si quieres aumenta la performance de clasificador