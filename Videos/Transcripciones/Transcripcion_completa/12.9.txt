12.9-Uso de CNN en OpenCV
https://www.youtube.com/watch?v=H-Az_kQktMs
 hola estamos hablando sobre el display ming y en este vídeo vamos a realizar código fuente para ver cómo usar las redes convencionales para calcular descriptores usando el lápiz de serie de tres que para poder ejecutar este este notebook hay que instalar el entorno que entonces bien simple pero hay que tener cuidado de que hay que instalar python 3.7 y basta con instalar el govern se ve en un país [Música] además el comando doble de jets que para descargar archivos y que en windows hay que bajarlo hay una versión libre de un binario o bueno punto se puede instalar fácilmente de hecho aceptará preinstalado entonces si instalan todo este entorno aquí vamos a ir ejecutando esto yo tengo el entorno con usb 3.4 punto 2007 la solución que vamos a hacer es descargar la lix net pueden descargar ejecutando esta serie es interesante ver dentro del sitio se ve hay distintas redes para descargar por ejemplo aquí está el mayor que las redes se definen el cb está integrado con casi todas las redes usan el formato de café café y lo hablamos en una librería que ya está y que tiene mucha mucha red ya entrenadas las redes en café se definen por un archivo productos dxt quienes tienen arquitectura y el archivo que hace el móvil que es el archivo grande donde están todos los pesos calculados hasta aquí pueden ver un escribirles que descarga la url y todos los archivos de ahí pueden viendo todas las redes que hay de dónde descargar en el archivo pronto txt y en los pesos bien entonces como se carga una red aquí vamos a descargar estos celulares de álex net el archivo de txt y el café moderno el archivo prototipo y este es un archivo de texto que define la arquitectura de la red y el café moderna un archivo binario solamente con pesos cuando vimos la explicación de la lexnet en total tiene como 60 millones de parámetros y cada pesos de ahí cada vez ocupa 4 gbytes un flow y por tanto son algo así como 240 megabytes el archivo que hacemos el archivo de texto de xp [Música] en un archivo de texto que muestra en las distintas capas está el nombre luego está en la cama de entrada donde input device era que se espera una imagen de unos 27 27 de tres dimensiones y archivos dxt tienes información de cómo fue entregada a la red porque cuando está entrenando la red se van guardando información aquí entonces no hay mucha información que ya no se usa cuando no la evalúan solamente por ejemplo está en dimensión igual 10 que es el centro no haciéndolo los mini maxis de duración arquitectura de lexnet aquí tiene una convulsión la convulsión 1 luego reguló organización pública la conducción 2 para la conclusión 1x event learning rey ya que es un parámetro de entrenamiento que aquí no se usa prestará convulsiones son 26 filtros de tamaño seguros y se evalúa la convulsiones 34 luego viene un arraigo de normalización de la capa de bullying de 3 por 3 contra 2 luego viene la capa conversión de aquí y aquí interesantes las figuras de las slides cuando la next net estaba esta figura que si se fijan aquí está a la mitad el tamaño de los poros de los 96 filtros y entonces una imagen de 227 por 227 se va a convertir en una 24 96 metros de profundidad 26 y el resultado va a ser de 55 x 55 de esa vida como nación y luego viene el max putin que está acá y voy a escribir otra composición la convocación 23 [Música] 5 5 15 y el bullying entonces aquí ya estamos en una capa aquí a esta altura en la imagen luego de todas las conclusiones va a quedar de 6 x 6 con profundidad 256 y esto es de la siguiente capa es la capa que se llama la full y connected 6 y porque multiplica la matriz y ahí se está de 4.096 aunque y luego viene la capa f 7 de 426 también y luego viene el arca primera que acaba de truffaut quien éstos usa cuando se entrenan y luego de la capa de 17 viene la capa de 13 8 que es la capa asia de 1000 de todos que es lo que va a generar la salida y para finalizar entonces son 1000 nodos pasan por una son máximo para que se sume 1 interpretarlo como probabilidad entonces esto de nuestra arquitectura entonces este archivo de texto contiene la arquitectura y es la forma de interpretar el archivo binario de los bytes de nuestro código fuente hacemos cargarla lexnet y carbón y es que uno puede imprimirle con esta leyenda la más capaz de exprimir el archivo frutos de equis y ahora cómo se usa esto debemos cargar la regla dejamos como la lix klett íbamos a clasificar imágenes para eso hay distintas imaginas desde pruebas y lo que vamos a hacer es que cada imagen que vamos a pasar aquí vamos a tener una raíz con todas las imágenes que queremos evaluar y lo que vamos a hacer va a ser pasados por la red y llegar a la capa final de probabilidades para obtener la capacidad de probabilidad de qué cosa es lo que se ve en la red como como etiqueta de la red comète y que en esa imagen y hay como 60 vamos con lo que se le va a mover la imagen para que la imagen es un archivo como en un panel de tres coordenadas pero para que ingrese a la red hay que convertirlos al formato en formato blog blog de los vinos del arte y que aquí es donde hay que ir a un par de consideraciones unas que es el tamaño aquí nosotros lo vamos a escalar a 227 puntos 27 y que hay que restar la media en algunos casos uno puede obtener no lo tengo aquí y que uno puede tener en la imagen promedio del cerco que fue entrenado y restar la imagen promedio pero en promedio uno puede restar el píxel promedio y el pixel promedio es la carga 104 117 124 o incluso uno podrían no saber cuál es el promedio no podría asumir que las imágenes son todas igual de blancas que oscura y el promedio sería 127 127 y no estaba muy lejos del promedio [Música] de él como ver como rgb aquí no puede forzar a que intercambien el primer y último canal no hay que hacerlo sin imagen y el chrome esto es interesante que hay que ver con éste croft porque aquí estamos diciendo que la imagen haciendo 27.27 bien pero la imagen que estamos cargando acá no es de 227 solamente más grande entonces como como obtener ese cuadrado si ponemos su propio westrup lo que va a hacer es que va a tomar el cuadrado central y la dimensión la dimensión menor la va a escalar a 227 y la dimensión mayor baker más grande que eso iba a tomar la zona central para que son cuadrados 97.700 entonces lo que hizo la argumentación es que dice que los escala solamente y por tanto va a deformar la el objetos bien quedan bien entonces vamos a tener el blog entonces la entrada en un sensor del archivo aquí en cuando inició blog sería la integración de un tensor con tensor que tiene el palito para hacer la red y en esto aquí a la red el ibex trabajo dar como entrada y la x el input y después decimos forward y forward es no va a entregar la salida y la salida es en lo que es un vector de dimensión 1000 con conectores de cómo es un [Música] como aquí la imagen recibe tan sólo esta cosa tan pensando para procesar una imagen sino bien para procesar una lista de imágenes por tanto tan sólo de cuatro de rango 4 porque tiene dos coordenadas tres coordenadas de la imagen excepto el ancho y la profundidad número canales pero va a ir hay una cuarta coordinada con un rango que es la de una red de imágenes y esto como resultaba retornar una raíz de vectores pero como entrega una imagen vamos a sacar el primera solamente dice albert tarde probabilidad de la imagen estén entregados a imprimir este vector de probabilidades por el primer actor de probabilidades como se interpreta se ven también probabilidades son mis coordenadas de las mil cosas que con quién fue entrenado el lexnet ya indicó y todos los enlaces de 15 nymex net los logran igual para poder interpretar estas mis coordenadas uno tiene un archivo que es el que se llama el sin ser words el chino de mogán es un archivo de mil líneas y el orden aquí no puede interpretar quiénes significan cada una de las neuronas de la salida de dos de las coladeras del vector de posibilidades verme en este este código de este código es el es el nombre de sin ser dentro de world net lo hablamos cuando hablamos de textos y aquí tengo 23 cuando hablamos de texto que exista warner para los none para los otros sustantivos aquí un montón de conceptos con un código y aquí tiene en la descripción es la relación entre los conceptos por ejemplo si vamos a ver algunos que a cualquiera este código y vamos al archivo de la oms y buscamos el que empiece con eso ice ah más este el código del flamingo entonces este es el 2007 que la coordenada 131 del vector flamingo y equipo ver que flamingo es del tipo que es un modo hijo de este código que debe estar más arriba que es el tipo y además 1 además tiene una descripción de ese flamingo uno puede ver una descripción en palabras y describe de alguna forma flamengo aquí y además de uno sino a ver este código no tiene sus códigos sus subsistemas y ciencias de derivados más específicas [Música] 1 del gallo un órgano ese código es el gallo un adulto mail ya un pájaro macho adulto y nota que quizá sea una gallega y la gallina lo buscamos y es un pájaro y vean que aquí uno puede ver el este código de ahí es el padre entonces ahí no puedes ver que estas dos coordenadas en la 89 hay una relación entre ellas sectores de aquí la gallina y eso se ve se puede sacar de wornat si no ve todas las definiciones de los códigos porque los dos tienen el mismo padre el padre es en ese código que es el pájaro este código está dentro de la mujer saque [Música] entonces es una de las cosas que hay que entender de que las mil cosas que salen de un clasificador de esos 1000 conceptos hay una relación implica que no puede empezar a procesar las viendo este archivo o en realizó descarga warner viene con una pie y ahí no puedes hacer preguntas y carga este archivo y hay uno las más preguntas más digital si tienen una espada desde el otro e incluso buena cual distancia entre estos conceptos porque entonces lo que vamos a hacer para imprimir el vector de probabilidades es que vamos a cargar este archivo estas mil líneas y vamos a calcular la coordenada de mayor probabilidad en realidad qué está haciendo aquí es que vamos a ordenar el vector de probabilidades vamos a obtener el orden vamos a ordenar también las dos sin sets y vamos a obtener los los tres primeros y los más un primer como cosas de saber el máximo y los los siguientes vamos a otro animal si ejecutamos esto el avión entonces si procesamos esta imagen e imprimió que el concepto 404 obtuvo el récord en agua de 104 tenía el valor mayor y si vamos al archivo al archivo de ciencia espalda cuando tenga 2 404 para 404 a 0 es ésta la del 29 por ciento de coca y con un 6 por ciento dice que es un un ala y tiene 0% para el gato de 150 egipcio 23 5 % [Música] aquí notar que uno diría que es un gato pero aquí las imágenes tienen sus decisiones de gato ahí hay razas de gatos [Música] y lo mismo con los perros con la siguiente imagen del perro tiene que mirar también una definición si vamos aquí ahora imágenes es un perro ovejero australiano es el que el pib y que si vamos a ver a los padres además tienen una jerarquía de los perros que son que es un tipo de perro [Música] algunos de los temas razas de pelo largo la siguiente imagen es como una imagen típica de ejemplo y busque otra imagen space chat y tengo un juguete y bueno a la lex net se equivoca de ahí le da un 13% bueno luego un auto de policía parece que un 90% estas son imágenes típicas así como de esa poner otra imagen es distinta por ejemplo este en este auto con un camión podríamos decir que lo reconoce como que es un un camión de la basura un medio cambian el camión de mi camión sin acoplado bien no está muy seguro después interesante la mascarilla este concepto mascarilla de que esta imagen ha reconocido como un día [Música] después volaron una empanada bachelet y curiosamente está súper seguro el 93% de que es una con una caracola y por último cuando está dentro de la máquina y lo reconoce con un cuento me siento como un chip quite qué es esto un volantín lo ponemos aquí estamos visitaron les quiten quite que vendría a ser hijos de un balcón y qué cualquiera de los pequeños o no [Música] entonces eso es muy interesante comentar que las cosas se están entrenando con imagináis para mis conceptos mil conceptos de salto en el mundo y mucho más cosas en especial se ve que esas mil cosas no es quizás tan uniforme de todas las cosas posibles sino que como que les gustan los perros les gustan los gatos porque hay subdividen varias razas pero uno hacía de sudamérica los animales siempre de lexnet alexis es un concepto un ambiente día histórico porque hay muchos finales la primera revolución de la red convencional pero si uno está para hacer algo interesante y por lo menos eso y aquí está para descargarlos y vamos qué es lo que dice la gente también más imágenes y para notar que habrá que descargar el otro proto txt y por la educación más aquí están laborales para descargar los datos descargados así que se carguen aquí de esto exista el punto que existe y se ve que aquí en la entrada de 224 más 227 2 24 y luego aquí están todas las composiciones que sea y no puedes ver son más convulsas y exactamente la misma estructura de fcc 617 y las lesiones nadal a la final entonces bien directo y vamos a la misma función de excepto y vamos a egipcios ahora estaba muy confundido posiblemente un lince y del perro por ahora la petición dice que es un perro alemán [Música] pero policial podría ser el despechado seguro y el otro también un space charlotte el auto de policía una polis van lo que el camión nuestro camino chileno no lo dice que es ahora dice que un police van bien bien bien así que se la jugó bien en cuanto a su porción de pulmón 100% de empleabilidad es un vehículo recreacional con mascarillas y que siento que un pañal la empanada de una una caracola un día como mañana y el ahora es un la américa [Música] un ejemplo interesante de ver que aquí para el auto de policía por cierto ver que la segunda opción una ambulancia con un 9 por ciento razonable qué pasa si es que sí que estamos confundidos sabemos que hay que dar vuelta los ejemplos canales de r&b si ponemos true y evaluamos de nuevo esto ahora dice que la imagen en una ambulancia ser tomar que ahora está interpretando mal el rojo con él solito azul rojo y empalizadas roja y entró un ambulancia entonces ahí vamos a ver que efectivamente para más lo último que vimos en la parte más teórica enlaces light es que uno usa las redes convencionales en regresión de información no no solamente en el uso es obtener la capa de probabilidades y ver qué es lo que es y todo al máximo sino que uno puede calcular una capa previa y con eso uno calcula un vector que el que permite que un descriptor para comprar distancia entre imágenes y uno puede ver qué imágenes que aparecen con otras y para hacer eso es lo que vamos a hacer aquí aquí vamos a calcular con la misma vejiga que estaba y está cargada aquí hay una función para calcular el pitcher de una imagen y con la misma imagen cargada vamos lo mismo la entrada excepto aquí al hacer forward le vamos a decir hasta dónde tiene que detenerse y nos va a entregar el sensor hasta donde hasta la hasta la capa donde uno le dice solamente porque las probabilidades no soy quiero la de 4.096 que está un poco antes y vamos a calcular el vector y ahí retornamos el vector aquí es sub zero porque porque esto un tensor de una red para la raíz de imagina de entrada de vectores y lo vamos a llamar para la bíblica de hiper tres vectores vamos a mostrar en l'aquila norma y los vamos a normalizar el contempló la distancia y entonces ahí vemos que el este el vector de 4.096 es un vector que la capa de cc 7 el vector de 4.096 uno lo mira el largo el largo es tienen estos largos pero cuando uno va a empezar a calcular compararlos con otros lo más común es normalizar es la norma 1 entonces para normalizar lo vamos a dividir por su normal el cual aparece más y entonces calculamos la distancia y aquí lo que puede con un país estamos victoria y la norma vigente le resta la diferencia y ahí no sabes las distancias y aquí se ve que es en el gato negro el perro negro esas dos fotos se parecen más de aquí están más lejos entre sí no esperaría si desaparecen un poco más o incluso están suscribían a sino sectores normalizando cuando hablamos de texto basta con calcular y va a dar lo mismo hay una fórmula para convertir de 2 x 1 - 0 en la ida y por similitud mientras más alto aún mejor entonces ahí el dato más similar a la foto del gato negro de más presión la foto granadino tiene el área [Música]