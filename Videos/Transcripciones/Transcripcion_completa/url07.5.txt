 hola en este vídeo vamos a hablar sobre análisis de componentes principales estamos viendo en el curso la búsqueda por similitud y cómo poder resolverla en forma eficiente para eso en un vídeo anteriores hemos visto distintos tipos de ir disfraz multinacionales y en especial cómo poder resolver en la búsqueda máxima y en las que nos permite ir mucho más rápido a un pequeño costo en la efectividad aquí vamos a hablar a ver otra de enfoque que consiste en 22 inclinaciones donde los vectores ahora son de un espacio de menor dimensionalidad este mal entonces la reducción dimensión consiste en que seguiremos victorias de animación de de los queremos llevar a un espacio de animación de la prima del más pequeño y eso nos va a significar que va a mejorar la eficiencia porque como animaciones vamos a tener distancias que se calculan más rápido y que vamos a necesitar menos memoria para mantener con descriptores [Música] por otra parte la efectividad la promesa estas técnicas incluso es que la efectividad puede mejorar y que se refiere eso es que aquí cuando uno reduce dimensión uno se está agotando dimensiones que son redundantes animaciones que contienen ruido por tanto el vector reduce un tamaño y también elimina información ruidosa y el vecino más cercano en el espacio reducido es un mejor resultado que el el vecino más cercano en el espacio original muy bien eso lo que una promesa y que podría cumplirse o no cumplirse en para estas técnicas de pensamiento nosotros vamos a asumir que el vecino más cercano según ha descrito original es el mejor vecino más cercano y que estos de que uno podría mejorar la efectividad reducción de nación esto sería parte de la técnica desde la etapa de cálculos descriptores pero cuando una etapa de búsqueda uno tiene que asumir que el vecino más cercano es el mejor descriptor y ahí vamos a asumir eso bueno aquí vamos a ver el análisis de componentes principales para entender estos bienes saber sobre qué son las transformaciones vectoriales una transformación ventilar de una función que convierte vectores de rd vectorial de rn prima de una menor de nación también y esto le vamos a llevar una transformación viendo las transformaciones éstas lo que hacían las transformaciones lineales que cumplen estas dos propiedades y es que la transformación de la suma es la suma de las transformaciones y que en la transformación de una escala en la escala de la transformación si algo cumple estas dos propiedades entonces la transformación si se quiere es lineal la íntima transformación es quien no va a interesar que realizaban las matrices de transformación como una matriz de porque prima es decirle aquí de primeras filas y de columnas no multiplicado por un vector x estimación de esto nos va a dar un vector de animación de prima y entonces de prima por de este vector es d depor uno importante hasta sectores de público y por tanto esta matriz de transformación es una transformación se puede probar no hay nada muy difícil que esta transformación vectorial de matriz es una transformación lineal es decir cumple estas propiedades transformaciones lineales y no fácil de probar porque estas propiedades la multiplicación por escalar y la suma de la matriz es cumplir la propiedad lo que es más interesante es que cualquier transformación lineal es decir cualquier transformación que cumple con estas dos propiedades es transformación lineal que corresponde a una batida de transformación eso es evidente pero sí tengo una transformación y veo que cumple la transformación lineal donde donde cumple las propiedades de transformación y entonces cuál es su matriz existe una matriz para esa transformación bueno aquí no nos vamos a probar esto esto como teorema pero si aquí dice que la demostración de que hay que esta matriz se obtiene calculando la transformación de los dos ejes es bueno entonces es interesante en las transformaciones lineales que son madrid en particular ahora vamos a tener un tipo de transformación lineal que es la alguna transformación cuadrada de deporte es decir vamos a convertir vectores dentro de un mismo espacio por ejemplo aquí se estudian las transformaciones típicas son por ejemplo matrices de rotación de traslación de escala se estudian en computación gráfica y que por ejemplo la matriz de rotación lo que hace que el signo tiene puntos en algún espacio uno los multiplica por una matriz y todos los puntos aparecen rotadas y van rotando los puntos en cierto ángulo porque hizo una matriz de transformación y la aplicamos sobre todos los puntos es interesante para una matriz de transformación descubrir si es que existen algunos vectores especiales para esa transformación de qué son los vectores que no son modificados por esta transformación de esos vectores y llamar algunos vectores propios de la matriz y en el caso aromatic de transformación por ejemplo es el justamente el eje de rotación el vector que está en el eje de rotación es un vector que cuando se multiplica por a aceptaremos que sea que no se ha modificado o que podría ser el mismo el mismo preocupes cara muy bien estos vectores son muy importantes debe decir que cuando modificó y le aplicó la transformación sobre el vector obtengo el mismo vector pero posiblemente escala es más estos vectores propios son muy importantes porque esencialmente definen la transformación que por ejemplo el ejemplo de la matriz de rotación que nosotros definimos sensible de física del primer año que una rotación en un eje se puede definir por un medio de su eje siempre y así es como acción como decimos que una rotación en este sentido se puede definir por su eje de rotación bueno justamente estos están vectores propios que es muy interesante descubrir cuáles son para una transformación lineal y cómo lo descubrimos mediante resolviendo este esta ecuación descubrir cuáles son los vectores b tal que a múltiples por hadas usted mismo y cómo se resuelve eso bueno esto es el canje o la primer año de ingeniería y se habla del polinomio característico y cuando este determinante sea igual a cero y aquí aparece un cual quiero aparecer un polinomio que es de grado de lambda que ha generado e importante tomate de soluciones de la matriz del deporte de soluciones con posibles múltiples con distintas multiplicidades temblando y luego para cada lambda uno apaga y descubre cuál es el de asociada al senado de ahí aparecen los de pares y el álgebra aquí pero hay un algoritmo entonces que nos permite descubrir cuáles son los valores vectores propios de una matriz eso estos valores estos porque no siempre están definidos depende de la matriz cierto pueden que hay algunas transformaciones lineales que no tienen estos ejes esto que estos vectores especiales pero entren en particular nos va a interesar un tipo de matriz que son las matrices simétricas con valores reales cuando la transformación línea es una matriz simétrica con valores reales entonces si existan sus valores propios y son dos reales pueden tener puede estar en multiplicidad mayor hoy y también se interesante es que sus valores sus vectores propios son perpendiculares entre sí es decir una matriz de transformación que va a tener un vector propio insuficiente de van a ser los trimestres perpendiculares entre sí y por tanto de si son de un espacio de determinaciones para ver de vectores propios todos ortogonales entre sí y además son todos unitarios está más dice que los vectores propios los actores propios forman un eje de coordenadas nada de eso es muy importante no elegí acordarlas para cambiar el eje de coordenadas los datos a los que no otra propiedad dice que como son ortogonales entre sí unitarios es que la matriz puede ser descompuesta de esta forma donde esté los vectores propias del propio uno como columnas y el il ha traspuesto de este vector q encuentra el puesto y eso eso también es interesante qué bueno si bien en cualquier son ortogonales y unitarias la matriz b es una matriz donde es una matriz diagonal donde están los valores propios de la diagonal portal de la matriz ya la transformación lineal puede ser descompuesta en una matriz con los vectores propios x una matriz lineal hasta las landas una de la onda de la diagonal de iu y su x la misma matriz en ahora también [Música] esta transformación se puede demostrar de hecho la demostración es aplicarla a la definición que vimos antes de que aborde igualdad lambda ronda por b y aquí uno ahora qué pasa si ponemos todo de una vez aquí bien entonces tenemos valores vectores propios y ya sabemos cómo calcular los y tenemos esta propiedad para las matrices simétricas ahora vamos a ver lo que el análisis de componentes principales tan conocida con nuestro nombre encontraron lo que vamos a hacer que vamos contar una transformación lineal del espacio de borde en el cual para un conjunto de datos vamos a hacer una rotación del espacio y vamos a eliminarlas covarianza y luego y eso va a permitir después de reduciendo naciones al descartar y naciones de varias y ahí se dice que cuando don descartamos dimensiones de menor varianza es porque esas dimensiones son las que tienen poca información es un concepto interesante donde dice el varianza la varianza de los datos está relacionado con la información cuando cuando los vectores tienen poca variación decir son esencialmente los mismos está muy cerca del promedio entonces decimos que hay poca variación tonos dato importante y poca información son poco interesantes o tablets y cuando hay mucha varianza sin mucha variación en estos datos son interesantes hay informaciones de su criterio interesante que hay que mantener y que por tanto apreciar lo que hace es que quiere reducir en acciones pero viendo la mejor cantidad de información posible o dicho transforma la mayor cantidad de variantes posibles del conjunto de parada para para entender cómo funciona apreciará tiene pequeños repaso de conceptos criminales dos dados venía datos la media el promedio y la varianza es esto no está aquí que esto se llama está dividido en oscuro se llama el días [Música] con esto porque se divide en menos de uno la razón viene porque se dividiría se dividirían n que es el error en la suma del arroz cuadráticas de cada tomo su promedio si es que éste fuera el promedio real dragones incluso se ha notado como pero este este de aquí lo estamos tomando del mismo conjunto y por tanto es parte del del sunp leonas con el sampleo de datos estamos tomando la media y luego estamos calculando el error con respecto a esa media es ampliar de salida de parte de la muestra y ahí es donde viene que hay un pequeño error y que lo que corresponde matemáticamente y no existe en que la más grande vaya significaría si es que lo dividimos por él [Música] y no queremos que este sea menos interesante es el de la covarianza entonces si tenemos dos conjuntos de valores equis y otras y n n valores y entonces podemos saber es la covarianza entre estos dos conjuntos como multiplicar la diferencia con respecto a su media y esto significa que esto va a dar un valor grande cuando un número cuando se aleja a su media en el x el conjunto a y también se aleja su médico si los aleja al mismo tiempo entonces estamos para sumar números grandes que dice que este que cuando uno se aleja del otro se aleja para el sentido opuesto entonces va a dar un valor cercano al valor muy bajo y si es que no están relacionados y cuando uno se aleja de su media el otro no se aleja y cuando los dos y se alejan los aleja y no hay relación entre youtube menezes las colonias de matar es esto las fórmulas varias y covarianza van hay que restarles la media [Música] eso no justifica también que estaría todo muy fácil de calcular las variantes lasko varianzas si es que la media bien los conjuntos es cero vamos vamos vamos a trasladar el origen hacia el centro de los datos así el promedio nos da tus cosas de forzar que esta media se igual a cero en los datos de entrada y de esa forma después las fórmulas que es bastante simples porque porque la covarianza ciento es cero la covarianza de multiplicar valores y la varianza es elevando su manera normal bueno entonces que dice el algoritmo etc da un conjunto de electores que los vamos a si va a ser una matriz de en el borde necesito bien para hacer nuestros descriptores los vamos a guardar por filas de esto se va a tener esto en las filas si las columnas de descriptores y lo que vamos hacer es entrar y qué significa eso que vamos a calcular que vamos a calcular por por columna el promedio de los datos de entrada isl obama respecto de su hijo es decir que el poder resumir j ahora va a ser el valor le vamos a restar el promedio de su columna y por tanto vamos a generar un data set donde vamos a calcular entonces el vector en el vector promedio que va a estar en el centro de estos datos y se los retamos a todos los datos y nos va a quedar en segundo set con mediaset en todas las demás ya que ver por qué queremos hacer eso porque ahora lo que vamos hacer es vamos que el cual la matriz de conveniencias la matriz de covarianza como vimos la de la definición anterior consiste en que dados dos conjuntos todos los conjuntos x va a ser el x1 y ahora cuáles son esos dos conjuntos vamos a tomar todos los pares de dimensiones y por tanto vamos a tomar la columna y con la fila j de la matriz xerez 27 gramos aquí tenemos de la columna 1 hasta la columna de vamos a crear una matriz de y los vamos a batir de covarianza y este deporte dónde vamos a calcular la covarianza de él y sus cuatro de sus cuates que consiste en tomar la columna y tomar la columna j y calcular la covarianza entre estos dos valores según ésta según esta forma y los vamos a poner aquí porque y eso nos va a ir diciendo aquí están correlacionadas están las distintas dimensiones de nuestros datos de la fórmula de la fórmula de la covarianza es claro que la matriz y valle es decir la covarianza de y contrajo está en lo mismo que es la covarianza de junto con ella por tanto las matrices varianzas tiene una meta y en el borde y eso nos dice que si le calculamos los valores y vectores propios álava tiende con varianzas y va a salir un resultado bonito donde tiene sus de valores propios y tiene sus de vectores precisos de vectores propios son ortogonales entre sí e qué significa para usted qué significan estos los valores de tres puntos de la matriz de corias la madre de covarianza tiene que ver con que si tenemos los datos dispersos y están muy correlacionados es decir hay una alta covarianza d la matriz de covarianza va a marcar entonces que hay cierto valor allá hay una alta y una alta correlación entre las dos acciones cuando calculamos valores victorias propios sobre la matriz de covarianza para aparecer el eje de a mayor con variantes el eje de mayor covarianza donde la covarianza máxima va a ser el propio y el otro y el segundo en este caso va a ser [Música] sobre los valores y vectores propios que tiene una matriz de colonias que sale en cualquier orden y nosotros nos va a interesar lo vamos a reordenar manteniendo ordenando los de mayor valor propio a mayor valor y los 20 espacios hay que asociarlo que son pares de su pareja el cabrón que consume un vector propio tranquilos vamos de la nación para que el primer la boya componente principal va a ser el que esté aquí estas personas componentes principales los conjuntos de vectores mares el componente principal que solo que les dan el nombre hasta que finalice de complementos decimales y estos de valores de el primero que está asociado al mayor valor propio el valor propio está asociado a la varianza a la varianza en este eje entonces el b1 es un eje como un sistema coordenadas de vectores de forma perpendicular entre sí cada uno de los lambda de los valores propios es la varianza postulante es la varianza en el eje del eje de uno y el andador es la varianza en el eje porque en la varianza porque estos son valores vectores que se calcularon de la matriz de corias por tanto el irlanda de es la varianza en el último como la ordenamos de mayor a menor este nombre de que es el varón esa es la coordenada que tiene la menor varianza decir la orden a que tiene la menor cantidad de información y es la candidata blanco ordenada candidata a ser eliminada entonces lo que vamos a ver qué vamos a como tenemos aquí es como que tenemos acá un eje esto es un sistema de coordenadas un sistema de coordenadas que que vamos a usar y vamos a transformar los datos del eje canónico que es donde vienen los vamos a convertir a este este eje de coordenadas que nos interesa porque aquí vamos a librar las cosas definir la transformación de esta forma por columnas de los planos por colombres y lo que vamos a hacer es que esta matriz es una matriz de transformación es de esta matriz tiene es una matriz que es deporte [Música] y que para multiplicar la col un dato segundo visto un vector de estos vector y la vamos a multiplicar por la matriz la hacemos trans puesto que se me quiere el vector 1 al vector al vector de si los multiplicamos con un vector x nos va a dar un vector transforma de ahí este vector transformado es decir aquí nos va a dar en el clima en este vector transformado es el vector este mismo vector pero ahora escrito en el sistema de coordenadas d de los vectores y esta misma transformación así como lo vamos a ir haciendo un metro por vector si lo hacemos sobre la matriz de la matilla real estamos notando de esta forma donde tenemos de columnas y tenemos que los menores tienes valores ahora lo queremos multiplicar por esta matriz del deporte y lo que hay que hacer aquí es que vamos a hacer esto atrás puesto es verlo más atrás puesto que una matriz desde seguramente la vamos a multiplicar con la matriz de borde y para hacer eso es que quiero aquí en lo que vamos a hacer es que tenemos la matriz donald está puesto utilizado por otra parte y quiero para enviar todos los vectores transformados y entonces en una matriz de las mismas medidas para la economía es esto que hace el otro puesto para volver a quedar con nada más ligero y por tanto a toda costa o era más fácil multiplicar el doble de por el otro lado la x 7 multiplicar el doble como esta los vectores en columnas la instale la matriz la matriz transformar ya por eso es que es un tema de cómo se estar escritos los datos que hay aquí que hay que multiplicar las matrices de esta forma la idea es que cada lector tiene que calcularse el producto punto con cada uno de los vectores propias y ahí va a salir y ahí se van convirtiendo las nuevas sistema de coordenadas bien si es que hacemos la transformación los datos y repriman tienen por cómo contribuir por cómo construimos el método y si le calculamos la matriz de covarianza al en los datos transformados y los datos transformados para tener covarianza ceros y su matiz de covarianza el diagonal esto es lo que toda la técnica que hemos visto antes para lograr tener un conjunto r que tenía unos matices con varianzas con datos ahora cuando eres multiplicamos por w ahora vamos a tener una réplica y este reprima tiene esta matriz de confianza la matriz de coria si estaba triste covarianza es una matriz varianzas diagonal de cierto no existe la covarianza y eso es algo que lo que buscábamos y weaver los que significan los vectores propios están los valores propios los valores propios son las varianzas y en el sistema de coordenadas el ejemplo de valores vectores propios se usan para el convertir en los datos del primer espacio original en el nuevo espacio diagonal y donde los valores propios dicen cuántas varianza llenas en esa dirección y como lo como lo habíamos del audio mayor a menor esté dando subte es la menor dimensión y es la dimensión candidata a hacer eliminar vamos a votar una vez que transformamos los datos botamos las últimas dimensiones y vamos a reducir la dimensión área y uno puede decir si tengo vectores de animación siempre no votan las últimas 20 naciones de eso parece un criterio pero como no puedes saber si es mucho o es poco bueno tú asiste líder esta matriz la matriz de la memoria es aquí está aquí está en todas las variantes en todos los ejes por tanto si calculamos la sumatoria de las landas eso es el total usted le llaman el total de las horas de la base de errol flynn y que cuando estamos borrando dimensiones vamos a ir descartando los lamas vamos a borrar los últimos porque son los mejores porque queremos quedarnos con un datar se está perdiendo la mínima cantidad de información y entonces los llevamos en es que vamos a calcular dónde prima y vamos vamos a saber cuántas varianza está quedando si es que sumamos nos la va a subir desde el agua algunas tan típicas y eso es lo calculado en la proporción con respecto a la suma total desde igual uno bastante y eso nos va a dar un indicador por qué y este indicador es el que nos dice cuánta varianza les digo me dice cuánto arias los varianza se retiene se me tiene entre entre uno y primaveras 1 - esto es 4 se perdió y usualmente no va a tener un valor un valor cercano por ejemplo 95% o 90% no tiene que ser muy bajo porque si no es si no tiene muchas variantes e italia los descriptores arduino y ya no nos sirven así que tiene que ser un valor un valor alto no estoy al 80%