10.07-Buscar y seleccionar coincidencias entre imágenes
https://www.youtube.com/watch?v=fxrucBQ5vNQ
 ya vimos cómo calcular descriptores locales de una imagen y ahora vamos a ver cómo comparar dos imágenes y aquí se ve dos imágenes que son la imagen ejemplo que hemos usado en el capítulo iv primero vamos a calcular los descriptores y entonces aquí cada círculo representa un tipo y por cada equipo tenemos descriptor como recuerdo para cada uno nuestro circuito entonces tenemos el balón x sigma que el tamaño y el ángulo y este el tiempo en perú y además de esto tenemos el descriptor sixto que es un vector de dimensión 120 con las orientaciones del gradiente de razones y entonces para esta imágenes tenemos 262 vectores de 260 y 128 y los vamos a comparar con los casi 2000 de la imagen para tratar de buscar las zonas parecidas entonces si hacemos eso lo que vamos a obtener es bueno vamos a para cada uno de los escritores de la imagen de la izquierda vamos a buscar el vecino más cercano según distance se suscribían en el espacio de animación 128 aquí no estamos usando equipo estamos usando el descriptor de la zona y vamos a comprar con estar suscribiendo que de hecho en esta búsqueda del vecino más cercano propone usar busquen aproximar con el cade trick que habíamos hecho previamente en el curso abril de hecho en realidad mismo muchas otras opciones y lo que vamos a hacer es que se va a asociar el descriptor de la imagen de la izquierda con su escritor más parecido o más cercanos dentro de la imagen de la derecha y eso le vamos a llamar un match entonces el beso y es un descriptor de la imagen de la izquierda y el nn del beso y es el vecino más cercano al borde de ese lector que va a ser un pintor de la imagen 2 que está la menor distancia y si hacemos eso vamos a obtener esta imagen y si asociamos con una línea a los descriptores los equipos correspondientes a los descriptores más cercanos y que lo que está diciendo esto es que junto con cada uno estos puntos hay descriptor una zona y que estas líneas transmisión de ahí porque el descriptor es decir el skipper que describe esa zona es muy parecido en estas imágenes también entonces incluso estas zonas están asociados gran zona está bien pero se ve que algunas líneas se van hacia cualquier parte extendiendo bien están encontrando el objeto entonces cómo podemos decidir si quiero que esto está o no está bueno para esto vamos a hacer un criterio doble lo vamos a hacer dos etapas en el primero vamos a filtrar un poco de líneas a través de un mirando las distancias de los vectores de animación 128 y nos vamos a quedar con los matches que sean buenos y esto un pie del individual es decir que aunque las líneas las vamos a testear y vamos a filtrar las que se vean que son muy malas a su distancia entonces y como segunda etapa vamos a hacer la tablilla de coherencia facial que vamos a buscar un grupo que vaya hacia un mismo lado tratando de ver sí que hay un objeto no compartido o zona compartida entre otras dos imágenes primero como filtrar en baches en forma independiente cabo bueno la primera idea es pintar por distancia y lo que vamos a hacer entonces es que como estamos asociando cada mentor con su más cercano además de eso tenemos el valor de distancia entre ellos de la distancia y con su vecino más cercano y si es que ese vecino más cercano está muy lejos entonces la distancia era muy muy alta entonces decimos que en realidad no está coincidiendo bien y entonces lo que vamos a hacer que vamos a fijar un umbral la estancia de ella y hay que ajustar es bueno veamos eso cómo sería esto lo que se ve por aquí tengo preparado un punto payton con el mismo ejemplo también entonces aquí lo que está haciendo aquí en vamos a leer estas dos imágenes que se llama la siguiente el 1 entre el 4 y les vamos calcular descriptores aquí están los equipos entre los distritos y aquí están las líneas de equipo está la función de texto que es retornar a la lista de equipo de zonas y eso lo usamos para el usar la función complete que retorne a los escritorios de esas zonas incluso lo pensé bien está la función detecta complete que hacer todos juntos por aquí bueno lo mantuve separado para mostrar que en realidad son dos etapas claramente separadas y que uno puede incluso combinar y pues de un algoritmo con escritores de otros algoritmos simplemente hoy incluso uno puede inventar equipo es lo que es bueno pero aquí vamos a los que detectan el mismo decir y vamos a asociar los más cercanos es decir puedo comparar los descriptores 1 y para cada uno de los escritores que están en este conjunto para buscar el más cercano incluso la función que se llama el bch que busca machine de vf de vino de bradford de fresa bruta y que le pasamos que use la normalidad y esencialmente va a ir a lo que hace quien fuerza prótesis para todos los distintos desde uno que calcula su distancia del segundo conjunto y crea una lista que se llama los baches y eso y eso para mostrarlos un objeto match la lista de objetos este objeto tienen esencialmente 3 atributos de líder en mantener números de equipo o número descriptor de imagen 1 el número de equipo de la imagen 2 y la distancia 3 entonces con eso podemos ir y buscar el objeto del equipo y aquí vamos a imprimir los datos del equipo de una imagen y del otro y su militancia y los vamos a llamar y entonces esto parece que le demos elegantes aquí se ve que los equipos están con esto de los círculos porque aquí dice que estos son los que se abre los rich y police y que garantiza aquí pasaba por aquí está mostrando el tamaño a esta altura como usted no es muy útil y quizá mejor son [Música] la opción dice que no dibuje los equipos sólo porque si quitamos esta opción de error entonces lo que va a hacer es que aparecen todos los círculos está mostrando todos los equipos y la verdad es que causó mucho mejor dejar esta opción y el color aquí no significa nada es solamente un número en sus colores al azar para para que no se vea como la gran la línea muy gruesa este es para acá la primera idea dice filtros por distancia como eso porque aquí está mostrando ahí la primera argentina 148 los 2700 y aquí aparecen todos los valores con su distancia y de hecho aquí tengo lo mismo pero vamos a mostrar vamos a centrar por distancia siempre está la misma función y sólo que aquí en la función buscar manchas llama a más el de fuerza bruta va a buscar manchas y lo va a ordenar por distancia hilos y nos vamos quedar solo con los que tengan distancia menor o igual a un valor umbral que vamos a definir aquí partimos con cliente un valor de grande y aquí aparece los mismos valores programas tenemos de lado por distancia y dice el más pequeño 55 y termina en 300 casi 400 entonces quedémonos con menos de 500 tiene un valor más alto que son 250 la mitad y se ve bastante al filtro bastante 200 está bien y falta un poco digamos 250 150 está bastante mejor y emoción transitando solo 25 pero casi todas también tenemos ninguno incorrecto todos correctos [Música] 10 10 pero vemos que visualmente podemos ver que están todos correctos todos están asociando la misma parte de él e pero no puede ser un poquito no tiene para que ser tan estricto y esto podemos probarlo con otras imágenes para que los tres y también funciona bien no es la misma pero más grande y se ve bien igual aquí tiene un poco de ruido que está asociando [Música] y de hecho aquí empieza a veces los problemas de hecho esta idea hay que hay que verlo funcionando para darse cuenta que esto de el umbral es la es la distancia no funciona muy bien de hecho nuestra idea bueno en este caso sí pero aquí tiene un caso un poco más difícil para darse cuenta que esto no funciona muy bien aquí están cuatro ejemplos tuvo uno estos son dos imágenes de esta central y aquí tenemos dos imágenes y ahí está un poco más difícil está un poco más realista porque esto es ejemplo a torrent l esto es lo que está buscando es casi exactamente igual a la consulta ya pero cuando no está buscando objetos en el fondo de consulta es casi un recorte de la otra imagen sino que aquí está y aquí está mostrando este juego bueno aquí aparece varias veces juego pero con distintas rotaciones y aquí vamos a estar aquí es como que se aparece en su posición y si es que buscamos porque está sembrar por ejemplo recién dijimos que están sombras 200 e incluso se ve algunos buenos y se ve mucho ruido y se quienes vemos aquí y 100 el filtro mucho desayuno correcto y un correcto digamos que pongo más estricto para eliminar por lo menos el incorrecto y si decimos 90 5 incluso el incorrecto era más cercano que el correcto y por qué sucede esto porque destruye la idea de que esté filtrar por el valor absoluto de la distancia es mala idea pero hay que aquí hay que verlo juntando para convencerse de que funciona ma jin y cualquier funciona mal porque es como se ve aquí el ruido coincide muy bien de esto se consigue mejor que lo que la correspondencia de eso también se ve aquí [Música] en este rollo están incorrectos en estas zonas de la torre de la base pero coincide muy bien porque efectivamente el pach el equipo en de esta zona que es muy parecido es el edificio entonces la coincidencia muy buena entonces con un valor umbral está muy difícil sacar eso porque porque esto empieza a decir que es como mala idea y principalmente porque el medio ambiente coincide entre las dos imágenes mucho mejor que el contenido mismo del objeto que estamos buscando y no funciona tampoco decir que el objeto que queremos filtrar no es idéntico entonces lo que hay que hacer es que con esta idea funciona filtran por umbral más que no hay que usarlo nunca funciona así que estamos buscando algo muy igual por ejemplo un logo de ahí dice que el logo es esencialmente el mismo o un patrón del mismo entonces el nombre de la vistazo conforme pero sé que un objeto no funcionarían igual el criterio en realidad el criterio es que dicen cuál es que tiene para eliminar el ruido de hecho si vamos a ver aquí en la lección y así como este coincidía coincidió mejor en esta zona el edificio también coincidía con cualquiera de las zonas de este edificio acá y también coincida con que coincidió con algunos de los de la torre externa con costos correctos y que son muy indistinguibles porque el país es muy muy poco discriminativo porque aparece varias veces repetido en la imagen entonces eso nos dice que estás como malo no es malo un mal equipo y que es muy probable que no se va a equivocar y cómo se da cuenta de eso es que cuando coincide con su vecino más cercano el segundo destino más cercano también estaba cercano el criterio dice que cuando la distancia a su vecino más cercano es muy parecida a su hija a su segundo al siguiente a la segunda opción entonces es por quien no es muy discriminativo y la idea de quien de los tiempos y que uno asocia de objetos de es tratar de asociar lo más discriminativo porque supone que el objeto es único el que estamos buscando entonces tiene que haber patrones que son únicos dentro de la imagen y el ruido está por todas partes entonces decir que hay un tipo izquierdo y sería muy bien y habían varios muy parecidos entonces probablemente no es nuevo [Música] por ejemplo no así que sí que una distancia de la mujer estaba distancia digamos 90 pero el segundo está a distancia 91 eso dice este tiempo estaba probablemente no es bueno y nosotros en realidad no interesa cuando por ejemplo la distancia el primero sea incluso mayor 100 pero la segunda opción y segundo vecino más cercano era 200 entonces está súper bien si queremos asociar cuando aunque esté en la consulta el vecino más cercano a éste de acá y nos interesa cuando es la segunda opción si está muy cerca entonces llegó en realidad cabeza poco discriminativo pero una interesa cuando uno cuando el vecino más cercano y el segundo está mucho más lejos y ahí hay una gran brecha y que nos permite decir que en realidad este match es muy bueno y entonces eso no es el valor mismo de la distancia lo interesante sino que es la relación entre las dos distancias de hecho este puede estar incluso más lejos que el anterior pero así que el segundo está mucho más lejos es bueno incluso podría estar las distancias 200 pero el siguiente 400 entonces hay que fijar un valor umbral y es temporal de eso un valor menor a 1 cierto que por definición del vecino más cercano del segundo es de un valor más grande que el primer otro sector va a ser casi 1 cuando sea algo muy malo y iba a ser mientras nos fijemos por ejemplo el 05 el sos súper estricto solamente cuando el vecino más cercano sea la mitad de la distancia sea la mitad del otro entonces aquí hay que probar con distintos valores y de hecho el de bioware el súper me propone cero 08 que es como un valor que provocó es muy imágenes y qué es un valor que si bien deja pasar un poco de ruido filtra la mayoría y la verdad que tampoco queremos estar estrictos porque para la segunda etapa de guayas espacial no sé qué voy a dejar pasaron un poco de ruido pero no mucho veamos entonces cómo funcionaba cómo funciona eso en dentro de nuestro ejemplo entonces aquí estamos con esto por distancias vemos entonces la distancia para el juego hubo 12 nuestra distancia 120 se ve que está mal es el umbral de estas presiones vamos a ver aquí tengo escrito el ejemplo con con el umbral con el umbral en la relación de las dos distancias no se quiere buscar la función buscar más es ahora uno le pide al marchar no que haga coincidencia con el más cerca nación que hace una búsqueda cada nn y le decimos que hay acá igual dos declararme los dos vecinos más cercanos y eso va a dar una lista de marchas y para cada uno de ellos los dos marchas y vamos a calcular la distancia de uno con expectación la tasa y si es que eso supera al umbral del caso caso la descartamos y sí que sí es bueno entonces nos lo pasamos a la lista del el match del cercano sí no entonces aquí por defecto estábamos con un valor 1 y bueno aquí están todos lo voy a equipar estos 2 richie points filtra 8 08 y se ve cómo se filtra ese rollo activa para arriba que tiene una sumar por la distancia ahora y desapareció claro porque así como coincida con algún ruido de arriba también ahí hay varias otras opciones muy cerca de impresión que se dejan y decidimos unos siete y de hecho interno como está quedando porque porque este patrón de las letras y el logo es único dentro la imagen entonces esos esos descriptores independiente y la distancia seguro que es su segunda opción va a ser va a estar muy lejos porque no hay otro igual 6 pero entonces como cómo funciona este este criterio bueno la misma idea aquí entonces en conclusión aquí la idea es que seleccionar los escritores distintivos es súper restrictivo porque hay porque votó un montón de equipos pero equipo abierto usualmente hay hay miles o ciertos y entonces queremos contar y quedarnos con unos poquitos con decenas días es suficiente y mientras sean buenos entonces tenemos súper mano para hacer ruido y cualquiera que está bueno aquí están las strike y compartíamos con 262 de ejemplo con 09 a 111 y pueden 08 27 65 58 y 41 vamos a volver 5 bueno esa es la idea de cómo uno opera con este primer filtro y luego ahora en la siguiente etapa es una distancia lo hecho aquí es cómo está quien queda casi todas bien y un par de ruido y esto con filtrar ahora haciendo el cálculo de el bruc