06.5-k-d tree
https://www.youtube.com/watch?v=TMyhMo5XV5Y
 hola en este vídeo vamos a hablar sobre el cade frío de los vídeo anteriores empezamos a hablar sobre los índices multinacionales y revisamos el índice de trin que divide o agrupa los vectores en rectángulos que los llamamos los bowling camps en este vídeo para entender este también antes hablamos sobre estructuras gratis y un repaso estructuras de datos para citas que también sería bueno ver este vídeo antes de ver este bueno nunca detrick es un árbol binario para ansiado que lo vamos a usar para hacer búsquedas de cnn en un espacio de generaciones cómo funciona un k de trip es lo que hacíamos va dividiendo el espacio y lo ordena los vectores mediante 22 valores que van a escoger una dimensión por ejemplo la nación 3 y va a escoger un número el 40 y va a decir para el lado izquierda están todos los vectores todos los vectores donde es la animación 340 y por otro lado está el resto es decir todos los que es la animación tres son mañana es que 40 lleva sucesivamente dividiéndolo un grupo porque después aquí manera apareciendo tres reglas o sea las mismas reglas que se van repitiendo esa manera agrupando los vectores de esa forma se lo radio interna alma será un nombre de nación acá y un valor x bien sumar con la izquierda contienen los rectores con coordenadas de la coordenada cara lo que son menos igual de equis tienen el derecho los vectores que la coordenada tienen un valor mayor que x y los nudos externos hicieron las hojas del árbol después el árbol en las hojas va a tener los vectores y los vectores que nosotros queremos buscar en ellos [Música] fue definido en el año 75 pero lo que va a hablar ahora no son los algoritmos que celebráis son de construcción de tiempo [Música] inicialmente de tries pensado como una extensión del árbol de búsqueda binario el largo en donde verán ese clásico de números y que dice a la izquierda están los que son menores el número de mayores aquí nunca de tria entonces dice un número par además dice la animación montón de exhibir ese número de turistas entonces este cadete de ejemplo aquí por ejemplo he mencionado antes y dónde ven aquí hacia la izquierda se están todos los vectores que tienen dimensión 1 la diversión uno de los menores que 2 y el en el lado derecho hasta los que son el mayor que dos y si bajamos ahora tenemos otra condición que dice que en el lado izquierdo son los que ven haciendo sonar igual a tres y hacia el derecho tóxico que la intimación dos son desde mayores 2 5 la izquierda y hacia la derecha 25 porque van a hacer la forma estructural no y que si fuera un árbol de schiavi nario y nos interesara nos interesa lario y hace la boca exacta y ver si que ésta estará buen ejemplo del vector 65 estará en el conjunto entonces es muy fácil porque uno tiene que ir viendo siguiente estas preguntas y uno encuentra si es que esto no es cierto o no pregunta que el el vector de búsqueda tiene la dimensión 1 menor a 2 conseguir me dice no ser humano sea ahora a la derecha y el vector que estoy buscando la asignación del menor y molas cinco meses y uno baja y baste insertar el c4 entonces si fuera una extensión directo del árbol de busca binario uno haría el mismo recorrido y aquí está el 64 no lo está y aquí uno estaría creando y hacer crear el crecer el árbol como a lo largo del camino y va creciendo por las hojas aquí una representación de el cadete de este mismo cadete nos dará entonces que esta pregunta que dice dimensión 1 menor o igual a 2 se puede representar uno dice es tu nivel plano de corte pero nosotros lo vamos a representar como rectángulos nos va a ser más fácil después la vida de clavos que y entonces qué es lo que estamos haciendo en el primer nodo estamos somos dividiendo el espacio completo en dos rectángulos el rectángulo izquierdo y que son todos que son menores o alejados la dimensión y el rectángulo de derecho son todos los que son mayores a 2 en la dimensión y cada uno de estos dos rectángulos luego cuando estamos acá consiste en vivir ahora en dos rectángulos hijos del retablo tiene que estar contenida en el ver tango lo anterior y que son los que esos menores y polesa tres y tres ordenados bueno y lo mismo es un hijo entonces es una subdivisión de la división anterior ni siquiera los que son menores o iguales a cinco y que son mayores cinco la diversión es porque en él hay que decir aquí entonces que son rectángulos y vamos a ir agrupando los vectores rectángulos estos distintos se parecen la matriz pero distinto porque esto es más honesto rectángulos no son deberes en el cade trim es un deber debería haber un dato en cada uno pero en una casa solamente que la cara de la división igual y lo distinto que relevante es que el cade tripartición el espacio completo es decir todos los puntos están dentro que dentro de algún restante es decir sido público acá esto siempre va a estar va a ver un rectángulo la diferencia como cómo vamos a construir el tri y lo vamos a construir de forma offline y vamos a decidir las coordenadas mirando la varianza lo que queremos hacer es que hay para mel coordenadas sino cuando los datos está muy dispersos y nosotros queremos crear rectángulos que sean más bien reducidos y como son más reducidos si si es demasiada varianza no son muy dispersos es el candidato para dividir los dos entonces si tenemos un conjunto de electores de asignación de una matriz de datos donde vamos a tener los sectores como filas y sus coordenadas para hacer columnas entonces lo que vamos a hacer es que vamos a calcular la varianza de cada una de las columnas la varianza de la dimensión de la dimensión 2 sumando unos cuadrados de la diferencia i la definición de marías etc la sumatoria de calcular la media de cada uno [Música] bueno y eso sería varianza y nido o estigma circular escuadra bueno entonces lo que vamos a que vamos a calcular en la varianza para cada una de las derivaciones maternales y vamos a escoger la dimensión de mayor valor y esa va a ser la habitación de donde vamos a dividir el conjunto y lo vamos a dividir según la mediana para que quede dividido en dos que el de la mediana la mediana es si tomáramos estos valores de la coordenada acá que es la que no sólo estamos cogiendo y los ordenados de menor a mayor es el valor central ya es decir la mitad lo de los números de ahí son menores que la mediana de los mayores es la definición de mediana en el caso es que sea un número par entonces la mitad sería promediar los dos valores ancares y y entonces después vamos a dividir el conjunto y vamos a poner arriba los que son menores que la mediana de la mediana hacer ese valor de corte en esta en los internos del árbol entonces entonces un algoritmo offline definimos los vectores los elementos están definidos no algoritmo online como los otros no iba aceptando los datos uno a uno y se van agregando el árbol aquí el árbol lo vamos a crear para n vectores imaginar fijo para eso en el estrés entonces podemos calcular el construcción consiste en la matriz de datos vamos que pueda la varianza de cada dimensión sigma una estas imágenes madre y si lo sujeta en la varianza de los valores de la columna j y vamos a buscarla la columna acá que tenga la mayor variantes y eso va a ser entonces digamos que esté la columna acá que tiene máxima la varianza al máximo al máximo y vamos a calcular a la mediana la mediana de los años valores de esta columna y luego vamos a usar esa mediana para dividir el conjunto en 2 no sé para qué está aquí los viernes y vamos a tomar las filas de las filas del conjunto r los que son menores a la mediana van a quedar en el psuv árbol izquierdo y los que son mayores que los que son mayor con el derecho y luego vamos a dividir recursiva mente en el conjunto y bien vamos a tener vamos a tener un conjunto vamos a tomar un valor una columna tomamos la mediana y vamos a dividir en dos ya no vamos a tener un subconjunto es en su conjunto tienen sus árboles donde vamos a tener aquí van bien eres filas ahora vamos a tener tres filas [Música] y cada uno entonces va a ser lo mismo para tomar va para dividirse de nuevos vas a tener que tomar escoger la máxima media para la máxima varianza de sus columnas y va a escoger una y va a tomar la mediana y lo va a participar en dos llevarán van a ser sus hijos y en el otro lado otra columna y ahí se van subiendo y eso va a terminar hasta que quede esencialmente un valor buena de parámetro cuántos árboles para cuántos nodos cuánto es la ocupación mínima que debe de tener una hoja y bueno y otro detalle de más de implementaciones que suceden con la mediana cuándo el siguieron repetidos puede que hayan junto la mediana esté repetida varias veces entonces bueno no va a quedar no va a quedar dividido en dos exactamente buenos detalles de implementación en general no nos va a suceder sé que son datos de flujos reales dp esto está utilizando hasta el final no sé si esto queda un árbol balanceado de poder en donde el bayern con altura de la nariz pasional e un ejemplo de un ejemplo muy pequeño si los trates de esta página donde aquí se ve que está cortando primero por estar presta por ganado y luego en cada uno cada árbol cada su conjunto se vuelve a dividir mostrar que no tiene por qué ser no digo por qué dividirse forzosamente en ordenar las dimensiones alternadas podría subdividirse en por la misma córdoba agua meses seguidas es posible y eso de hecho esto va a suceder cuando cuando la varianza alguna dimensión sea mucho más grande claro porque cuando la debido por la mitad la varianza disminuyen y sitting y disminuyendo la varianza sigue siendo la más grande que la otra entonces se volverá a dividir por eso entonces por ejemplo que estaba aquí está su segundo corte y aquí el tercero en este caso serían y luego de arriba [Música] y ese portal aquí de vuelta y es que como hacer una búsqueda del vecino más cercano como todo elemento siempre está dentro de un google dentro de algún rectángulo entonces es muy fácil saber y así como verte algoritmo localizar el rectángulo la hoja que contiene al vector co todos los algoritmos para participar y uno puede entonces buscar el vecino más cercano en la hoja que contiene unos días de nuestra mano porque el vecino más cercano podría estar en la misma hoja equipo y ese rectángulo contiene puntos y va a acercar uno diría podría uno podría estar aquí pero aquí en este mismo ejemplo se ve quién no es el caso y quién no ahora ahora uno una vez que uno más cupo en el árbol según este 11 que tenemos en cada tren 4 [Música] y uno en el boe y uno más bajo y aquí estamos ahora como no continua y aquí es donde viene una diferencia con los algoritmo original afirmamos nuestra la hora el algoritmo original era lo que es una búsqueda recursiva donde va calculando va cortando ramas según lo que se llama la provincia que es la distancia al candidato actual entonces que nosotros tenemos una distancia que un candidato de stronismo rectángulo entre célula distancias candidatos y con esta distancia con esta distancia uno puede ir recorriendo la cual de forma positiva y se va saltando ramas que uno vea que está más lejos que la distancia al candidato pero una búsqueda recursiva no sólo ya mismo cuando hablamos del enre triqui una mala idea porque está fijo en el orden de recorrido del árbol y está fijo y eso ese orden predefinido y no que uno ya se va a ir hacia la izquierda primero y luego hacia la derecha puede que no sea bueno y que la mejor forma consiste en ir decidiendo una forma más dinámica cada decisión por dónde ir bajando y qué árbol que su árbol y el visitante y cómo se hace es cómo se hace eso mediante lo que definimos con el libre trick y se va él me dice que en la distancia mínima a un rector entre un objeto consulte todos los rectángulos de l restringe brillo y en el cade tree y hay una distancia mínima una estancia mínima hacia donde la distancia a la cual eventualmente podría haber un vector que es la zona más cercana de una región con un rectángulo cualquiera y aquí está el míster esa distancia en ese punto ahí como la cinta si todos aquí entonces nuestro estudio y el algoritmo de búsqueda de hecho es el mismo que el que hablamos para leer y dónde vamos a ir recorriendo el árbol vamos a ir recorriendo el árbol pero cada región como es un rectángulo solamente que la región es un rectángulo más grande o más chico pero un rectángulo vamos a calcular bien disco de cada uno de los restantes los rectángulos donde está contenido q de cero por tanto seguro quién va a hacer eso la primera la primera la primera bajada de los vamos a ir agregando las regiones a una cola emplearía que vamos a llamar la actriz page y lista qué va a hacer un virgen estando realmente está brindis de cv a la registradora y aquí vamos a ir poniendo orígenes y la vamos a ir agregando acá y esto se va a ir ordenando por mí y vamos a estar dando una región la visitamos visitar y si y si eso o tiene el árbol sacamos esta región y la visitamos que consiste en recorrer sus hijos y si esos hijos son otras regiones se agregan al índice y se van a ubicar la posición que les corresponde y van a ser visitados cuando el corresponde dice que dice que no ha visitado tiene vectores hay que visitar todos sus vectores el mismo deberíamos parar de hecho criticó entonces el ritmo de búsqueda al primero desemboca recursiva que tiene validez pero que sí se puede hacer y de hecho algunas librerías simplemente así si uno va cortando regiones que son más lejanas y candidatas pero una versión mejorada y usando una escuela de prioridad dónde vamos a ir recorriendo el árbol nos vamos a ir recorriendo en forma incluso para ir saltando la primera pero vamos a bajar por un camino que el que contiene aquí son todo un índice igual a cero y luego cómo continúa esto continúa recorriendo el siguiente recorriendo el siguiente modo expandiendo el siguiente modo que tenga menor índice que podría ser entonces eso es útil porque permite ir recorriendo el árbol donde es más probable que hay un vecino más cercano entonces una prioridad y donde el orden y como vimos también es una este algoritmo es más eficiente incluso es óptimo en el número de nodos visitados para encontrarles el más cercano pero tiene un mayor coste en espacio porque eventualmente con mala suerte o en muy alta nación vamos a tener con todo el árbol dentro de la previa y cambió en búsqueda de positiva e incluso en este caso siempre va como usaba tracking dentro del estar siempre va a requerir logaritmo de no2 del mismo restaurante bueno el tri y una una mejora bueno una mejora se llama el random a skype a qué se refiere esto es que hay que notar que un 12 una matriz de datos con los genes vectores existe recordar de la construcción existe un único de carácter y para un conjunto de apps así que el kadri óptimo porque es el que va a maximizando el que escoge la máxima varias cadenas el máximo de gente para que además de una opción por el máximo ya que sería un caso pero ya no no no común pero en general para un conjunto de vectores cerca de tres único como podríamos tener más de un k de triplay de aquí que para poder generar varios k de tris de un mismo conjunto vamos a relajar un poco la condición de escoger el máximo la máxima varianza y la vamos a relajar un poco para escoger no necesariamente la máxima pero si una entre las máximas no es la mejor pero sí una buena de lo que vamos a usar entonces entonces vamos a construir en la misma construcción vamos a tomar dentro de por ejemplo las siento tienen nuestras tienden acciones vamos a ver dentro que calcular la varianza para las indignaciones dentro de esas 100 varianzas vamos a tener cinco puntos para las cinco máximas y dentro de estas cinco máximas escogemos las cinco mayores escogemos una cualquiera al azar ahí viene el nombre del grano más porque queremos eso porque ahora de un mismo conjunto de datos del mismo conjunto de datos vamos a calcular varios cadetes y ahora si es posible en el palanca de pies del mismo conjunto de datos y esto le va a llevar mucho y aquí hay un ejemplo de nunca the tree de un conjunto de datos y para los mismos datos otro cadete bueno aquí es con dos dimensiones de canal como quien no tiene mucho entidades e parámetros de de por qué las áreas de las dos de las dos máximas que son todas las posibles importante finalmente todo entraron las divisiones a lasarte ya no no no no sé qué es un espacio de muchas naciones iniciativa o tomar la máxima para no tomar cualquiera gas al que podría ser una muy bueno vamos a ver por qué queremos hacer esto es porque es que uno puede hacer lo que se llama un la búsqueda acá en ello no puede terminar la artes como la cola de prioridad va avanzando en mi lista de seguro puede uno puede retornar antes de tiempo y el ratón al candidato hasta ese momento y gracias ese candidato no era tan malo y ese es el vecino más cercano y otras veces no tenemos el stop de para el algoritmo de búsqueda vamos entonces va a ser cerca de three pero todo funciona mejor si es que vamos a hacer el mismo algoritmo pero buscando en todos los que vendrían mismo tiempo pero aquí vamos a tener varios cada país para los mismos datos el segundo motivo del tres calles y vamos a buscar el vecino más cercano cómo hacemos eso vamos a crear una activista y vamos a ingresar acá a las regiones raíces de los tres de los tres al brest a una misma cola de prioridad entonces de la región 1 del árbol 1 a la región 1 3 y vamos a ir desarrollando el haciendo el algoritmo de búsqueda el mismo algoritmo de búsqueda sólo tener las regiones son de un árbol de los recuerde esto va a que el ordenador es un mil por mil y el vamos a tomar entonces el mínimo que es la región más cercana q y lo vamos a visitar entonces y sale este los vamos a visitar y eso significa que aquí ahora es necesario e ingrese en la región 2 y 3 del árbol 1 y se tienen que agregar acá en la posición que él corresponde y la región 22 del árbol 1 y la región 3 del árbol y esto es para crear de los portales 2002 y luego solicita la siguiente supongamos que ahora va a visitar la del otro y se va a encargar acá y aquí va a aparecer en la región tuvo que aparecer la región 3 de largo de la versión 2 de ladrones y aquí la siguiente más está acá usualmente debe partir así porque las raíces van a tener distancias 0 con el disco que las raíces son más grandes y probablemente con tener aquí así que pero después después se hace más interesante porque cómo continúa esto va a ir bajando en los árboles en las distintas regiones que contienen primero y después te va a ir siguiendo en los distintos árboles por todas las regiones que están más cerca tipo el ejemplo anterior aquí que cuesta aquí y esta q y por tanto está en los mismos datos maestras así que va a suceder que primero vamos a visitar va a ir visitando los dos árboles al mismo tiempo se va a visitar finalmente la región que está en este y la región bien contiene aquí en ambos seguro que son esas dos regiones para hacer la primera visita porque son aquellas distancias me dice 0 la diferencia viene ahora como continúa como continuó el algoritmo para en este árbol el volumen dista aquí arriba un disco de esta década y para volver atrás de estas tres regiones que se vean cerca y aquí van a ver otras regiones cuál recuerda estar entonces vemos en regiones para visitar cuál es la región que vamos a visitar dentro dentro de esas seis lay que tengan un índice menor está la clave razonable la cola de inferioridad y en este caso va a ser probablemente va a ser ésta y en esta va a haber un vecino más cercano o va a haber otro candidato podría ser mejor o peor que el que yo tenía y después y ahora para la siguiente región puede que sea la del honor me la idea aquí es que como están los mismos datos partición a los de distintas formas hay muchos rectángulos alrededor de entonces cuando uno visite con un par de visitas a las regiones que tengan los 1.010 bajo muy probablemente 1 patri bless sino más cerca de entonces vamos a visitar unas pocas regiones y vamos a retener el algoritmo vamos hacer la pista y vamos a retornar y no damos garantía que sea el destino más cercano pero así probablemente lo es y vamos a ir muchísimo más rápido porque no nos buscamos todas las regiones necesarias y menos a mostrar unas cuantas para buscar candidatos candidatos y probablemente si vas del vecino más cercano como hasta ahora vamos a recorriendo los mismos datos en distintos dinero fue de no reportar dos veces el mismo el mismo [Música] el mismo vector pero simplemente entonces el enterrando mezcla de ti no interesa para la búsqueda próxima y eso que aproxima si hacemos esto el turismo va a ir mucho mejor va a encontrar decir más cercanos más rabia aunque no las garantías va a fallar puede estar bien no tiene sentido hacer un algoritmo con random arcade trick para encontrar y hacer una búsqueda exacta porque es mejor hacer un único callithrix y más son un pullover de buscar en varios árboles para hacer una búsqueda exacta es mejor con un árbol de hecho en realidad [Música] aproximada es mucho mejor vamos a ver ahora con un ejemplo